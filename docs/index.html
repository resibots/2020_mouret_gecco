<!doctype html>
<meta charset="utf-8">
<style>
body {
  overflow-x: hidden;
}
.scroll-down {
  width: 80px;
  height: 40px;
  right: 10px;
  bottom: 10px;
  position: absolute;
  font-family: "Roboto","Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size: 12px;
  font-weight: 300;
  color: #FFFFFF;
  opacity: 0;
  -webkit-transition: opacity 2s ease-in;
  -moz-transition: opacity 2s ease-in;
  -o-transition: opacity 2s ease-in;
  -ms-transition: opacity 2s ease-in;
  transition: opacity 2s ease-in;
}
.scroll-down span {
  margin-top: 5px;
  position: absolute;
  left: 50%;
  transform: translate(-100%, 0) rotate(45deg);
  transform-origin: 100% 100%;
  height: 2px;
  width: 10px;
  background: #FFFFFF;
}
.scroll-down span:nth-of-type(2) {
  transform-origin: 0 100%;
  transform: translate(0, 0) rotate(-45deg);
}
.spinner {
  position: absolute;
  height: 160px;
  width: 160px;
  -webkit-animation: rotation .6s infinite linear;
  -moz-animation: rotation .6s infinite linear;
  -o-animation: rotation .6s infinite linear;
  animation: rotation .6s infinite linear;
  border-left: 6px solid rgba(0, 174, 239, .15);
  border-right: 6px solid rgba(0, 174, 239, .15);
  border-bottom: 6px solid rgba(0, 174, 239, .15);
  border-top: 6px solid rgba(0, 174, 239, .8);
  border-radius: 100%;
  top: calc(50% - 100px);
  left: calc(50% - 80px);
  right: auto;
  bottom: auto;
}

@-webkit-keyframes rotation {
  from {
    -webkit-transform: rotate(0deg);
  }
  to {
    -webkit-transform: rotate(359deg);
  }
}
.transparent {
  opacity: 0;
}

figcaption {
  padding: 0.5em;
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
  text-align: left;
}

dt-article figcaption {
  padding: 0.5em;
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
  text-align: left;
}

dt-article figcaption a {
  color: rgba(0, 0, 0, 0.6);
}

dt-article figcaption b {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

*.unselectable {
    -moz-user-select: -moz-none;
    -khtml-user-select: none;
    -webkit-user-select: none;
    -o-user-select: none;
    user-select: none;
}
*.svgunselectable {
    -moz-user-select: -moz-none;
    -khtml-user-select: none;
    -webkit-user-select: none;
    -o-user-select: none;
    user-select: none;
    background: none;
    pointer-events: none;
}

.btn-group button {
  background-color: orange;
  border: 1px solid #FF6C00;
  color: white; /* White text */
  padding: 5px 12px; /* Some padding */
  cursor: pointer; /* Pointer/hand icon */
  float: center; /* Float the buttons side by side */
}

/* Add a background color on hover */
.btn-group button:hover {
  background-color: #FF6C00;
}
</style>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <!-- roboto font -->
  <link href='https://fonts.googleapis.com/css?family=Roboto:300' rel='stylesheet' type='text/css'>

  <meta name="theme-color" content="#ffffff" />


  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-141682504-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-141682504-1');
  </script>


  <!-- SEO -->
  <meta property="og:title" content="Weight Agnostic Neural Networks" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Networks that can already (sort of) perform tasks with random weights." />
  <meta property="og:image" content="https://weightagnostic.github.io/assets/img/wann_card_rect_v2.png" />
  <meta property="og:url" content="https://weightagnostic.github.io/" />
  <!-- Twitter Card data -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Weight Agnostic Neural Networks" />
  <meta name="twitter:description" content="" />
  <meta property="og:site_name" content="Weight Agnostic Neural Networks" />
  <meta name="twitter:image" content="https://weightagnostic.github.io/assets/img/wann_card_square_v2.png" />


</head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">

<!--<script src="lib/jquery-1.12.4.min.js"></script>
<script src="lib/mobile-detect.min.js"></script>-->
<script src="lib/template.v1.js"></script>

<script type="text/front-matter">
  title: "Quality Diversity for Multitask Optimization"
  description: ""
</script>
<body>
<div style="text-align: center;">
<video class="b-lazy" data-src="https://storage.googleapis.com/quickdraw-models/sketchRNN/wann/mp4/wann_cover.mp4" type="video/mp4" autoplay muted playsinline loop style="display: block; margin: auto; width: 100%;" ></video>
<table style="width: 100%;" cellspacing="0" cellpadding="0"><tr>
<td width="50%"><figcaption style="text-align: center;">A weight agnostic neural network performing <i>BipedalWalker-v2</i> task at various different weight parameters.</figcaption></td>
</tr></table>

</div>

<dt-article id="dtbody">

<dt-byline class="l-page transparent"></dt-byline>
<h1>Quality Diversity for Multitask Optimization</h1>
<p></p>
<dt-byline class="l-page" id="authors_section" hidden>
<div class="byline">
  <div class="authors">
    <div class="author">
        <a class="name" href="https://scholar.google.fr/citations?user=lp8V_UYAAAAJ&hl=en&oi=ao">Jean-Baptiste Mouret</a>
        <a class="affiliation" href="https://members.loria.fr/jbmouret">Inria, CNRS, Université de Lorraine</a>
    </div>
    <div class="author">
        <a class="name" href="http://blog.otoro.net/">Glenn Maguire</a>
        <a class="affiliation" href="https://g.co/brain">Inria, CNRS, Université de Lorraine</a>
    </div>
  </div>
  <div class="date">
    <div class="month">April 17</div>
    <div class="year">2020</div>
  </div>
  <div class="date">
    <div class="month">Download</div>
    <div class="year" style="color: #FF6C00;"><a href="https://arxiv.org/pdf/2003.04407" target="_blank">PDF</a></div>
  </div>
</div>
</dt-byline>
</dt-byline>
<p>Quality Diversity (QD) algorithms are a recent family of optimization algorithms that search for a large set of diverse but high-performing solutions. In some specific situations, they can solve multiple tasks at once. For instance, they can find the joint positions required for a robotic arm to reach a set of points, which can also be solved by running a classic optimizer for each target point. However, they cannot solve multiple tasks when the fitness needs to be evaluated independently for each task (e.g., optimizing policies to grasp many different objects). In this paper, we propose an extension of the MAP-Elites algorithm, called Multi-task MAP-Elites, that solves multiple tasks when the fitness function depends on the task. We evaluate it on a simulated parameterized planar arm (10-dimensional search space; 5000 tasks) and on a simulated 6-legged robot with legs of different lengths (36-dimensional search space; 2000 tasks). The results show that in both cases our algorithm outperforms the optimization of each task separately with the CMA-ES algorithm.</p>
<h1>Introduction</h1>
<p>Quality Diversity (QD) algorithms are a recent family of optimization algorithms that search for a large set of diverse but high-performing solutions <dt-cite key="mouret2015illuminating,cully2017quality,pugh2016quality"></dt-cite>, instead of the global optimum, like in single-objective optimization, or the Pareto frontier, like in multi-objective optimization. For instance, when optimizing aerodynamic 3D shapes, a user might want to be presented with multiple low-drag solutions of diverse materials and curvatures, and then select the best one according to criteria that are not encoded in the fitness function, such as aesthetics <dt-cite key="gaier2018"></dt-cite></p>
<p>So far, QD algorithms have very promising results for at least robotics, engineering, and video games. For example, a QD algorithm was used to evolve repertoires of diverse gaits for legged robots~<dt-cite key="cully:hal-01158243,chatzilygeroudis:hal-01654641,duarte2017evolution,kaushik2020"></dt-cite>; in computer-aided design, similar algorithms were used to propose shapes of high-speed bicycles with various curvatures and volumes <dt-cite key="gaier2018"></dt-cite>; in artificial intelligence for games research, QD algorithms have been implemented to generate procedural content like game levels or spaceships <dt-cite key="gravina2019procedural"></dt-cite>.</p>
<p>In essence, QD algorithms solve multiple tasks at once. For instance, a QD algorithm that evolves gaits to reach each point in the plane is actually solving the task &quot;how to reach (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span>)?&quot;, for each value of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span> within their respective bounds: each of these tasks could be solved separately with a single-objective optimization and a fitness function that computes the distance between the achieved position and the target. The &quot;magic&quot; of QD algorithms is that they reuse solutions that might have been unfit for some tasks (e.g., we want to reach (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">y_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>) but we arrived at (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2, y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>)) to solve another task (e.g., reaching (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2, y_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>)).</p>
<p>However, these algorithms require the family of tasks to have a very specific structure, namely, that both the features of the candidate solutions (i.e., the specification of the task) and the fitness values can be obtained from a single call to the fitness function. While this is the case for some tasks, like walking in different ways (we can measure the features of the gaits and the fitness during the simulation) or evolving shapes of different volumes (we can measure both the fitness and the volume from a generated candidate), there are many families of tasks for which a different fitness call is required to know the performance of a candidate for each task. For example, we might want to find a diverse set of policies or trajectories to address:</p>
<ul>
<li>Walking gaits that work for a family of damage conditions --- the best gait with a missing front leg; the best gait with a shortened back leg; etc. In this case, we need to simulate the robot under each of these conditions separately in order to determine the performance for each task\footnote{Please note that this is different from finding many gaits for the same morphology, like in <dt-cite key="cully:hal-01158243"></dt-cite>, which can be achieved with a traditional QD algorithm: such gaits are often useful for different morphology (e.g., for damage recovery), but they are not explicitly selected for this.}.</li>
<li>Grasping many different objects, each of them with a different grasping policy. Here we also need to simulate the grasping of a each object to know how well particular a set of parameters will perform.</li>
<li>Successfully completing all the levels of a video game, which requires playing each level in order to determine how well a given policy performs on a given level.</li>
</ul>
<p>Current QD algorithms cannot solve this kind of multi-task challenge without evaluating the fitness function on all the tasks, which requires a prohibitively large number of evaluations when the number of tasks is large (e.g., more than a few dozen).</p>
<p>In this paper, we propose an extension of the MAP-Elites algorithm <dt-cite key="mouret2015illuminating"></dt-cite> that solves numerous tasks simultaneously (more than a few thousands) when the fitness function must evaluated separately for each task. The key intuition in our approach is that a high-performing solution for a task is likely to be a good starting point to solve another task of the same family. This means that solving all the tasks together, like in QD algorithms, should be faster than solving each of them independently. This similarity between solutions for different tasks (or niches) was studied in previous work in QD <dt-cite key="vassiliades:hal-01764739"></dt-cite>, which led to the conclusion that high-performing solutions occupy a specific hypervolume of the genotype space in spite of being evenly spread in the diversity space. Stated differently, the high-performing solutions that QD algorithms find are different -- by design -- but are similar in the genotypic space. We hypothetize that a similar effect happens when solving many tasks simultaneously.</p>
<p>Compared to the MAP-Elites algorithm <dt-cite key="mouret2015illuminating"></dt-cite>, this paper proposes an algorithm to select the task, that is, the right &quot;niche&quot; (or cell) on which to evaluate each of the candidate solutions that are generated by the variation operator. This task selection operator uses the distance between the tasks (e.g., the distance between the parameters of two tasks) to exploit their similarities. The rest of the algorithm is the same as the vanilla MAP-Elites except that behavioral descriptors are replaced by task descriptors, which are chosen beforehand instead of being extracted from the evaluations.</p>
<h1>Related Work</h1>
<h2>Quality diversity algorithms</h2>
<p>Quality diversity algorithms are descendants of Novelty Search~<dt-cite key="lehman2011abandoning"></dt-cite>, behavioral diversity maintaintance~<dt-cite key="mouret:hal-00473132,mouret:hal-00687609,mouret:hal-00473147"></dt-cite> and niching methods like fitness sharing <dt-cite key="sareni1998fitness"></dt-cite>. Like Novelty Search and behavioral diversity, they define diversity in the &quot;behavioral space&quot; (or &quot;feature space&quot;), which is defined by descriptors of the features of each candidate solution observed during the evaluation of the fitness <dt-cite key="lehman2011abandoning, mouret:hal-00473132,mouret:hal-00687609,mouret:hal-00473147"></dt-cite>. For instance, two robots might cover the same distance but with a different trajectory: if the objective is to go as far as possible, these two robots would have the same fitness but different behavioral descriptors.</p>
<p>QD algorithms fall into two categories <dt-cite key="cully2017quality"></dt-cite>: population-based algorithms and archive-based algorithms. Both kinds use an archive to store previously encountered solutions. In population-based algorithms, the archive is used to steer a population towards new parts of the search space. For example, in Novelty Search with Local Competition <dt-cite key="lehman2011evolving"></dt-cite>, a multi-objective optimization algorithm (NSGA-II) ranks individuals according to two objectives: their fitness relative to their behavioral neighbor in the archive and the mean distance to individuals already in the archive. By contrast, in archive-based algorithms, the archive \emph{is} the population: new individuals are created by selecting parents from the archive and applying the variation operators (mutation and cross-over).</p>
<p>MAP-Elites <dt-cite key="mouret2015illuminating"></dt-cite> is one of the most used archive-based algorithms because it is conceptually simple and leads to good results <dt-cite key="cully:hal-01158243,chatzilygeroudis:hal-01654641,duarte2017evolution,kaushik2020,gravina2019procedural,gaier:hal-01518698"></dt-cite>. MAP-Elites divides the feature space into niches (or bins) according to a regular grid <dt-cite key="mouret2015illuminating"></dt-cite> or a centroidal Voronoi tesselation <dt-cite key="vassiliades2016scaling"></dt-cite>. This grid corresponds to the archive, which is also called a &quot;map&quot;. Each niche only holds the highest-performing individual found so far for this bin, which is called the &quot;elite&quot;. To create new candidate solutions, parents are selected uniformly among the elites, classic genetic operators are applied, and both the fitness and the features of the offspring are evaluated. The offspring then compete with the current elite of the niche that corresponds to its behavior features: if the niche is empty then the offspring is assigned as the elite of that niche; if the niche is already occupied, then the fitness of the current elite and that of the new candidate are compared, and the best is kept.</p>
<p>A recent study revealed that the elites often occupy a particular part of the genotype space, called the &quot;elite hypervolume&quot; <dt-cite key="vassiliades:hal-01764739"></dt-cite>. Intuitively, this observation means that elites have things in common or that they use similar &quot;recipes&quot;, so that they are well spread in the feature space but concentrated in the genotypic space. Species in nature follow a similar pattern as they occupy different ecological niches but share a large part of their genomes. For example, fruit flies and humans share 60% of their genome <dt-cite key="fruitfly"></dt-cite> while being vastly different animals. When evolving a vector of parameters, this hypervolume can be leveraged by using a variation operator inspired by the cross-over: if two parents are selected from the elite hypervolume, individuals on the line that connects the two parents are likely to be in the hypervolume too, that is, to also be elites (e.g., if the hypervolume is spherical, then any point on the segment that links two random points is also in the sphere). Given two random elites <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbf{x}_{i}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0448em;"></span><span class="strut bottom" style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span><span class="vlist"><span style="top:0.27686399999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span style="top:-0.5198em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi>j</mi></mrow><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbf{x}_{j}^{(t)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0448em;"></span><span class="strut bottom" style="height:1.4577719999999998em;vertical-align:-0.4129719999999999em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span><span class="vlist"><span style="top:0.2768639999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-0.5198em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>, a new candidate solution <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo>)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbf{x}_{i}^{(t+1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0448em;"></span><span class="strut bottom" style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span><span class="vlist"><span style="top:0.27686399999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span style="top:-0.5198em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> is generated by:</p>
<p>\label{sec:sota}</p>
<p>\label{eq:line}</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo>(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo>)</mo></mrow></msubsup><mo>=</mo><msubsup><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msubsup><mo>+</mo><msub><mi>σ</mi><mrow><mn>1</mn></mrow></msub><mrow><mi mathvariant="script">N</mi></mrow><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mrow><mi mathvariant="bold">I</mi></mrow><mo>)</mo><mo>+</mo><msub><mi>σ</mi><mrow><mn>2</mn></mrow></msub><mrow><mo fence="true">(</mo><msubsup><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi>j</mi></mrow><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msubsup><mo>−</mo><msubsup><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi>i</mi></mrow><mrow><mo>(</mo><mi>t</mi><mo>)</mo></mrow></msubsup><mo fence="true">)</mo></mrow><mrow><mi mathvariant="script">N</mi></mrow><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">  \mathbf{x}_{i}^{(t+1)}=\mathbf{x}_{i}^{(t)}+\sigma_{1} \mathcal{N}(0, \mathbf{I})+\sigma_{2}\left(\mathbf{x}_{j}^{(t)}-\mathbf{x}_{i}^{(t)}\right) \mathcal{N}(0,1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.15em;"></span><span class="strut bottom" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="base displaystyle textstyle uncramped"><span class=""><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span><span class="vlist"><span style="top:0.276864em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span style="top:-0.5198em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">t</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class=""><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span><span class="vlist"><span style="top:0.276864em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span style="top:-0.5198em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">I</span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size2">(</span></span><span class=""><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span><span class="vlist"><span style="top:0.276864em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-0.5198em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class=""><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span><span class="vlist"><span style="top:0.276864em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span style="top:-0.5198em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit">t</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mrow><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>σ</mi><mrow><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">σ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> are hyperparameters that define the relative strength of the isometric and directional mutations, respectively, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">N</mi></mrow><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathcal{N}(0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span> is the normal distribution with a mean of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span> and a standard deviation of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span>.</p>
<h2>Multitask optimization and learning</h2>
<p>To our knowledge, no work in evolutionary computation considers solving thousands of tasks simultaneously. Nevertheless, recent work on &quot;Evolutionary Multitasking&quot; <dt-cite key="gupta2015multifactorial,da2017evolutionary,hashimoto2018analysis"></dt-cite> do attempt to optimize for a few  (typically 2) tasks simultaneously using an evolutionary algorithm. In the most popular algorithm of this family, each individual of the population is assigned a task depending on a &quot;skill factor&quot; (an arbitrary number) that is initially chosen randomly, then transmitted to the offspring by randomly assigning the skill factor of one of the parents during cross-over. The tasks are typically weakly related (e.g. Rastringin and Ackley function) and no explicit information from the distance between the tasks is exploited.</p>
<p>Multi-task Bayesian optimization focuses on solving multiple correlated tasks when the fitness function is expensive <dt-cite key="pearce2018continuous"></dt-cite>, for instance when tuning a machine learning algorithm to several datasets or to tune a policy for a robot that depends on the context <dt-cite key="fabisch2014active"></dt-cite>, like a walking controller that depends on the slope. The general idea of Bayesian optimization <dt-cite key="brochu2010tutorial"></dt-cite> is to use the previous fitness evaluations to predict the location of the most promising candidate solution, evaluate it, update the predictor, and repeat. Gaussian processes are usually used to make predictions because they are good at interpolation and they can estimate the uncertainty of the prediction, which is useful in driving exploration.</p>
<p>In multi-task Bayesian optimization, the Gaussian process takes the task coordinates as input, in addition to the candidate solution, which allows the algorithm to predict the performance of every candidate solution on every task, and therefore to choose the most appropriate candidate to evaluate. Overall, multi-task Bayesian optimization solves the same problem as Multi-task MAP-Elites. However, it is tailored to situations in which the fitness function can be called only a few thousand times because the cost to query the Gaussian process is cubic with the number of fitness evaluations. Hence, this algorithm works well only for low-dimensional search spaces (up to six in most papers) and low-dimensional task spaces (up to 5 in <dt-cite key="pearce2018continuous"></dt-cite>). By contrast, the present work considers tasks that are up to 12 dimensions and candidate solutions that are up to 36 dimensions, but using up to 1 million fitness evaluations.</p>
<p>Lastly, a few algorithms have been proposed in deep reinforcement learning for multi-task learning. In this field, the goal is to learn a single, task-conditionned policy that maximizes the expected return for all the tasks. The general assumption is that a large part of a policy can be re-used accross the tasks (e.g., the visual processing part), and therefore it should be beneficial to learn all the tasks simultaneously. A recent benchmark paper proposed a set of 50 robotic tasks and extended deep reinforcement learning algorithms to multi-task learning (e.g., PPO <dt-cite key="schulman2017proximal"></dt-cite>, TRPO <dt-cite key="schulman2015trust"></dt-cite>, SAC <dt-cite key="haarnoja2018soft"></dt-cite>). The authors report that the best algorithm only solves 36% of the 50 tasks. Compared to Multi-task MAP-Elites, these algorithms solve fewer but more complex tasks and do not know the correlation between the tasks in advance.</p>
<h1>Multi-task MAP-Elites</h1>
<h2>Problem Formulation</h2>
<p>\label{sec:problem}
Current QD algorithms assume that the fitness function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mrow><mi>θ</mi></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">f(\mathbf{\theta})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">θ</span></span><span class="mclose">)</span></span></span></span> returns both the fitness value <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">f_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">x</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> and a feature vector (or behavioral descriptor) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="bold">b</mi></mrow><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{b}_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">x</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>x</mi></msub><mo separator="true">,</mo><msub><mrow><mi mathvariant="bold">b</mi></mrow><mi>x</mi></msub><mo>←</mo><mi>f</mi><mo>(</mo><mrow><mi>θ</mi></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">    f_x, \mathbf{b}_x \leftarrow f(\mathbf{\theta})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">x</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class=""><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">x</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">←</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">θ</span></span><span class="mclose">)</span></span></span></span></span></p>
<p>By contrast, we are considering a fitness function that is parameterized by a task descriptor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>τ</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{\tau}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.1132em;">τ</span></span></span></span></span> and returns the fitness value:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>x</mi></msub><mo>←</mo><mi>f</mi><mo>(</mo><mrow><mi>θ</mi></mrow><mo separator="true">,</mo><mrow><mi>τ</mi></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">    f_x \leftarrow f(\mathbf{\theta}, \mathbf{\tau})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">x</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">←</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">θ</span></span><span class="mpunct">,</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.1132em;">τ</span></span><span class="mclose">)</span></span></span></span></span></p>
<p>The task descriptor might describe, for example, the morphology of a robot or the features of a game level; it is typically a vector of numbers that describes the parameters of the task. In addition, we assume that we have access to a meaningful similarity function between tasks, denoted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>(</mo><mrow><msub><mi>τ</mi><mn mathvariant="bold">1</mn></msub></mrow><mo separator="true">,</mo><mrow><msub><mi>τ</mi><mn mathvariant="bold">2</mn></msub></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">d(\mathbf{\tau_1}, \mathbf{\tau_2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">τ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathbf">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">τ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathbf">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<p>The overall objective is to find, for each task <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>τ</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{\tau}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.1132em;">τ</span></span></span></span></span>, the genome <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi>θ</mi></mrow><mi>τ</mi><mo>∗</mo></msubsup></mrow><annotation encoding="application/x-tex">\mathbf{\theta}_\tau^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.9414399999999999em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">θ</span></span><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.1132em;">τ</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">∗</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> with the maximum fitness:</p>
    \forall \mathbf{\tau} \in T, \mathbf{\theta}_\tau^* = \textrm{argmax}_{\mathbf{\theta}} \big(f(\mathbf{\theta}, \mathbf{\tau})\big)

<p>Contrary to previous work, we consider domains with many tasks, typically a few thousand.</p>
<h2>Algorithm</h2>
<p>The Multi-task MAP-Elites algorithm is based on the main principles of MAP-Elites <dt-cite key="mouret2015illuminating,vassiliades2016scaling"></dt-cite>:</p>
<ol>
<li>the diversity space is divided into a large number of niches (or cells) that are organized spatially in an archive (also called &quot;map&quot;);</li>
<li>each niche contains the best known solution (the elite) for the corresponding combination of features;</li>
<li>to generate a new candidate solution, two random elites are selected from the archive and the traditional cross-over and mutation operators are used.</li>
</ol>
<p>In Multi-task MAP-Elites, each niche corresponds to a task. The main difference with MAP-Elites is how the niche is determined: in MAP-Elites, this comes for free during the evaluation of the fitness ($\mathbf{b}_x , section \ref{sec:problem}), but in Multi-task MAP-Elites, we need to \emph{decide} on which task (\mathbf{\tau}$) to evaluate the fitness function.</p>
<p>Intuitively, we want to select a task for which the newly generated candidate has a chance of being fitter than the existing elite.
Our main hypothesis is that two tasks that are close in terms of task distance are likely to also have close solutions; we therefore can choose a task that is close to the niche of one of the parents used to generate the new candidate solution. Choosing a task in the immediate neighborhood of a parent would lead to very limited exploration and was not successful in our preliminary experiments. Instead, we need a \emph{bias} for close tasks while keeping some randomness in the choice to encourage exploration.</p>
<p>Taking inspiration from selection in evolutionary algorithms, we use a \emph{tournament}: we randomly pick <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> tasks (including tasks for which no elite currently exists), and then from among these, we choose the task closest (in terms of the task distance) to the task of the first parent. This bias is strong when the tournament is large, because we are more likely to pick a task that is close to this parent, and weak when the tournament is small, since we are less likely to pick a close task. In the extreme cases, a tournament of size of the number of tasks corresponds to always taking the task closest to that of the first parent, while a tournament of size 1 corresponds to no bias for proximity at all (i.e., a uniform random choice of the task).</p>
<p>The size of the tournament is therefore critical to the performance of the algorithm. This could be a hyper-parameter, but it is likely to depend on the domain and to require extensive experimentation. Instead, we use a parameter control technique <dt-cite key="karafotias2014parameter,eiben1999parameter"></dt-cite>, wherein we attempt to identify the best tournament size &quot;on the fly&quot; using the data generated since the start of the algorithm. Our measure of success is the number of niches &quot;invaded&quot; during a batch of evaluations (e.g., during the last 64 evaluations), that is, how often the newly generated candidate is better than the existing elite for the selected task. For a given tournament, we denote by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mrow><mo>(</mo><mi>g</mi><mo>)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">r^{(g)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8879999999999999em;"></span><span class="strut bottom" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> the number of successes for a batch of size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span> (e.g., 64 successive evaluations) at generation <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span> (each generation is a batch), and by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mrow><msub><mi>τ</mi><mi>j</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">A_{\tau_j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:1.03555em;vertical-align:-0.35222em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">A</span><span class="vlist"><span style="top:0.14999999999999997em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">τ</span><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.07142857142857144em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> the current elite for the task <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>τ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\tau_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.1132em;">τ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.1132em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> that was selected for the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>-th candidate of the batch:</p>
<p>\begin{equation}
r^{(g)} = \sum_{j=1, \cdots, B} \mathds{1}<em>{f(\theta_j, \tau_j) &gt; A</em>{\tau_j}}
\end{equation}
Where:
\begin{equation}
\mathds{1}<em>{f(\theta_j, \tau_j) &gt; A</em>{\tau_j}} = \left{
\begin{array}{ll}
1 \textrm{ if } f(\theta_j, \tau_j) &gt; A_{\tau_j}\
0, \textrm{ otherwise}
\end{array}
\right.
\end{equation}</p>
<p>\begin{algorithm}
\caption{Multi-task MAP-Elites}
\label{algo:multi}
\begin{algorithmic}[1]
%        \Procedure{MT-Map-Elites}{<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span>:tasks, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span></span>:fitness}
\State \Colorbox{\textbf{[Parameters]}}
\State <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span>: vector of tasks
\State <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mo>⋅</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">f(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span>: fitness function
\State <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>(</mo><mo>⋅</mo><mo separator="true">,</mo><mo>⋅</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">d(\cdot,\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mpunct">,</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span>: task distance function
\State \Colorbox{\textbf{[Hyperparameters]}}
\State <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span>: number of random individuals for initialization (e.g., 100)
\State <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span>: total number of evaluations (e.g., <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>5</mn></msup></mrow><annotation encoding="application/x-tex">10^5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">5</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>)
\State <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span>: batch size (e.g., 64)
\State <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span></span></span></span>: (vector) possible tournament sizes (e.g., <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mn>5</mn><mo separator="true">,</mo><mn>1</mn><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mn>0</mn><mn>0</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">[1, 5, 10, 100]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">5</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mclose">]</span></span></span></span>)
\State \Colorbox{\textbf{[1. Random initialization]}}
\For{<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>←</mo><mn>0</mn><mo separator="true">,</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">i \gets 0, K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span><span class="mrel">←</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span>}
\State x \gets \textrm{random\_individual()}
\State \tau \gets \textrm{random\_task(T)}
\State <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi mathvariant="normal">.</mi><mi>f</mi><mi>i</mi><mi>t</mi><mo>←</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo separator="true">,</mo><mi>τ</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">x.fit \gets f(x, \tau)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit">t</span><span class="mrel">←</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.1132em;">τ</span><span class="mclose">)</span></span></span></span> \Comment{Evaluate fitness on task <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.1132em;">τ</span></span></span></span>}
\State <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>[</mo><mi>τ</mi><mo>]</mo><mo>←</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">A[\tau] \gets x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.1132em;">τ</span><span class="mclose">]</span><span class="mrel">←</span><span class="mord mathit">x</span></span></span></span> \Comment{Store <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span> in archive <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span></span></span></span>}
\EndFor{}</p>
<pre><code>    \State \Colorbox{\textbf{[2. Main loop]}}
    \State $s \gets \textrm{random\_in\_list}(S)$
    \Comment{$s$: tournament size}

    \State $\textrm{selected} \gets \textrm{zeros}(\textrm{len}(S))$  \Comment{\# of selections for each size}

    \State $\textrm{successes} \gets \textrm{zeros}(\textrm{len}(S))$
    \Comment{\# of successes for each size}
    \State $e = 0$ \Comment{Evaluation counter}
    \State $g = 0$ \Comment{Generation counter}
    \While{e &lt; E}\Comment{For all the evaluation budget}
        \State $\textrm{selected}[s] \gets  \textrm{selected}[s] + 1$ \Comment{Count selections of $s$}
        \State $g \gets  g + 1$ \Comment{Increase the generation counter}


        \For{$i \gets 0, B$}\Comment{Iterate over a batch}
            \State \Colorbox{\textbf{[2.1 Generate $x$]}}
            \State $p_1 \gets A[\textrm{random\_task(T)}]$\Comment{First parent}
            \State $p_2 \gets A[\textrm{random\_task(T)}]$\Comment{Second parent}
            \State $x \gets \textrm{variation}(p_1, p_2)$\Comment{Mutation \&amp; cross-over}

            \State \Colorbox{\textbf{[2.2 Select the task with a tournament of size $s$]}} \label{algo:tournament}
            \State $\textrm{tasks} \gets s \textrm{ random tasks from } T$  \Comment{Candidates}
            \State $\tau \gets \textrm{closest}(tasks, p_1.task, d)$ \Comment{Tournament}
            \State $x.fit \gets f(x, \tau)$ \Comment{Evaluate fitness on task $\tau$}
            \State $e \gets e + 1$ \Comment{Increase evaluation counter}

            \State \Colorbox{\textbf{[2.3 Try to add $x$ to the archive]}}
            \If{$A[\tau]$ = $\emptyset~\textrm{ or }~x.fit &gt; A[\tau].fit$}
            %\State \Colorbox{\textbf{[2.3.1 Add $x$ to archive]}}
            \State $A[\tau] \gets x$ \Comment{Add $x$ to the archive}
            %\State \Colorbox{\textbf{[2.3.2 Update the success counter for $s$]}}
            \State $\textrm{successes}[s] \gets \textrm{successes}[s]  + 1$ \Comment{Count success}
            \EndIf
        \EndFor{}
        \State \Colorbox{\textbf{[2.5 UCB1 algorithm for the tournament size]}} \label{algo:ucb1}
        \State $s \gets S\big[\textrm{arg}\max_{j}\left( \frac{successes[j]}{selected[j]} + \sqrt{\frac{2 \ln(g)}{selected[j]}} \right)\big]$
        \State \Comment{See eq. \ref{eq:ucb}, $j \in 0, \cdots, len(S)$}
        %% \Comment{UCB1}
    \EndWhile{}
%  \EndProcedure{}
\end{algorithmic}
\end{algorithm}
</code></pre>
<p>Among the parameter control approaches<dt-cite key="karafotias2014parameter"></dt-cite>, multi-armed bandits are both straightforward to implement and well founded theoretically. In evolutionary computation, they have, for instance, been successfully used to select the genetic operators <dt-cite key="dacosta2008adaptive"></dt-cite>. The general idea of multi-armed bandits is to consider each choice (here, each tournament size) as a slot machine with an unknown probability of reward. The objective of the bandit algorithm is to efficiently balance exploitation --- choosing a tournament size that we know can give a good reward --- and exploration --- choosing a size that has not so far been tried very often. It should be noted that the choices in bandit algorithms are \emph{not} ordered, that is, we ignore the fact that a size of 10, for example, is likely to lead to a reward similar to a size of 11. An ordered version of the bandit algorithms would be Bayesian optimization <dt-cite key="shahriari2015taking"></dt-cite>, but this would be a much more complex algorithm that requires many design choices and much more computation.</p>
<p>One of the simplest and most effective bandit algorithms is UCB1~<dt-cite key="auer2002finite"></dt-cite>, which achieves the optimal regret up to a multiplicative constant. Given a set of choices organized in a vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span></span></span></span> of size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span> (for instance <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>=</mo><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mn>0</mn><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mn>0</mn><mn>0</mn><mn>0</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">S=[1, 10, 100, 1000]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mrel">=</span><span class="mopen">[</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mclose">]</span></span></span></span>), let us denote by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">n_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> the number of times that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> has been selected so far. The tournament size <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>g</mi></msub></mrow><annotation encoding="application/x-tex">S_g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> at generation <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span> is given by:</p>
<p>\begin{equation}
\label{eq:ucb}
S_g = S_{m}, \textrm{where } m = \textrm{arg} \max_{i, \cdots, k}\left(\hat{\mu}_i+ \sqrt{\frac{2 \ln g}{n_i}}\right)
\end{equation}
where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><msub><mi>μ</mi><mi>i</mi></msub></mrow><mo>^</mo></mover><mo>=</mo><mfrac><mrow><msub><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mo>⋯</mo><mo separator="true">,</mo><mi>g</mi></mrow></msub><mrow><msubsup><mi>r</mi><mi>i</mi><mrow><mo>(</mo><mi>g</mi><mo>)</mo></mrow></msubsup></mrow></mrow><mrow><msub><mi>n</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\hat{\mu_i} = \frac{\sum_{j=0,\cdots,g}{r^{(g)}_i}}{n_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.358587em;"></span><span class="strut bottom" style="height:1.808587em;vertical-align:-0.44999999999999996em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit">μ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:0em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.617227em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mop"><span class="op-symbol small-op mop" style="top:0.074995em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="minner">⋯</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord scriptstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="vlist"><span style="top:0.28628571428571425em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span style="top:-0.5233714285714286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped"><span class="mord scriptscriptstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span> is the mean reward (i.e., success) of choice <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span> since the start of the algorithm. When a choice is taken often, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">n_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> increases and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msqrt><mrow><mfrac><mrow><mn>2</mn><mi>ln</mi><mi>g</mi></mrow><mrow><msub><mi>n</mi><mi>i</mi></msub></mrow></mfrac></mrow></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{\frac{2 \ln g}{n_i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.226118em;"></span><span class="strut bottom" style="height:1.84002em;vertical-align:-0.613902em;"></span><span class="base textstyle uncramped"><span class="sqrt mord"><span class="sqrt-sign" style="top:-0.036118000000000094em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size2">√</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="mord textstyle cramped"><span class="mord reset-textstyle textstyle cramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span><span class="mop">ln</span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span style="top:-1.146118em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span></span></span></span> decreases, which makes it less likely for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> to be chosen again. At the same time, we tend to choose the tournament size that has a good mean reward (i.e., success) so far (a high value for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mrow><mi>μ</mi></mrow><mo>^</mo></mover><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\hat{\mu}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle cramped"><span class="mord mathit">μ</span></span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>).</p>
<p>Algorithm~\ref{algo:multi} shows the detailed pseudo-code for Multi-task Map-Elites. It follows the MAP-Elites algorithm with the following exceptions:
\begin{itemize}
\item a tournament is used for the niche selection (line \ref{algo:tournament});
\item tournament size is adjusted using UCB1 (line \ref{algo:ucb1}).
\end{itemize}</p>
<p>While Algorithm \ref{algo:multi} is not parallelized, it is easy to do so by generating and evaluating all the candidate solutions of a batch (lines 26--35) in parallel, then attempt to add them to the archive one by one (line 36). This strategy prevents concurrency problems when adding elements and counting successes (for the bandit). Our implementation is in Python and uses this strategy to parallelize the fitness evaluations.</p>
<p>The link to the source code is available in appendix.</p>
<p>\section{Kinematic arm with variable morphology}
\label{sec:arm}
\begin{figure*}
\begin{center}
\includegraphics[width=0.94\textwidth]{figures/arm/figure_arm}
\end{center}
\caption{\label{fig:results_arms}(A) Arm with variable morphology. The objective is to find the angles <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>α</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mo separator="true">,</mo><msub><mi>α</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_1,\cdots,\alpha_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="minner">⋯</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> so that the tip of the arm is as close as possible to the target. The task is parameterized by the link length (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span></span></span></span>), which is the same for each link, and the maximum angular rotation of each joint (\alpha_{\textrm{max}}). All the results in this figure are for a 10-link arm. (B) Typical map generated with Multi-task MAP-Elites. (C) Typical map generated when using CMA-ES for each task. (D) Typical map generated with MAP-Elites when evaluating each candidate on each task. (E) Mean fitness over the whole map with respect to the number of evaluations (20 replicates). The solid line represents the median over the replicates and the light zones the interquartile range. (F) Mean fitness over the whole map after 1 million evaluations. All the differences are statistically significant (Mann-Whitney U-test, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>1</mn><mn>0</mn></mrow></msup></mrow><annotation encoding="application/x-tex">p &lt;10^{-10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mrel">&lt;</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>), except between MAP-Elites with evaluation on all tasks and random sampling.  (G) Influence of the tournament size on the mean fitness. (H) Mean fitness after 1 million evaluations.}
\end{figure*}</p>
<p>\subsection{Methods}</p>
<p>We first evaluate Multi-task Map-Elites with a planar kinematic arm inspired by previous work <dt-cite key="cully2017quality,vassiliades:hal-01764739,cully:hal-01158243"></dt-cite> (Fig. \ref{fig:results_arms}-A):
\begin{itemize}
\item The objective of the task is to find the angle of each joint (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>α</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mo separator="true">,</mo><msub><mi>α</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_1, \cdots, \alpha_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="minner">⋯</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>) so that the tip of the arm (the end-effector) is as close as possible to a predefined target in the plane.
\item The dimensionality <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span></span></span></span> of the problem is defined as the number of joints (which is equal to the number of links).
\item By contrast with previous work, we parameterize the arm by the length of the links, denoted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span></span></span></span> (all the links have the same length), and the maximum angle for each joint, \alpha_{\textrm{max}} (all joints have the same limits).
\end{itemize}
A task <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>τ</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{\tau}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.1132em;">τ</span></span></span></span></span> is defined by a particular combination of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span></span></span></span> and \alpha_{\textrm{max}} (the task definition is therefore 2-dimensional), and a candidate solution is defined by a vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>α</mi></mrow><mo>=</mo><msub><mi>α</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>⋯</mo><mo separator="true">,</mo><msub><mi>α</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{\alpha}=\alpha_1, \cdots, \alpha_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="minner">⋯</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">α</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span></span></span></span>-dimensional), where increasing <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span></span></span></span> increases the task complexity. The joint limits \alpha_{\textrm{max}} and the lengths are normalized by the dimensions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span></span></span></span> so that the robot has the same total length (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span> meter) and reaching abilities regardless of the dimensionality:
\begin{eqnarray}
\alpha_i &amp;=&amp; \frac{1}{d} \cdot (\alpha_i - 0.5) \cdot  \alpha_{\textrm{max}} \cdot  2 \pi\
L_\tau &amp;=&amp; \frac{L}{d}
\end{eqnarray}</p>
<p>The fitness function f(\mathbf{\alpha}, [L, \alpha_{\textrm{max}}]) is the Euclidean distance from the tip position <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">p_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">d</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> to the target position <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span>. In these experiments, we arbitrarily set the target to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(1,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span>. The kinematics of the arm can be computed iteratively as follows:
\begin{eqnarray}
M_0 &amp;=&amp; I\
M_{i+1} &amp;= &amp;M_i \cdot  \left(
\begin{array}{llll}
\cos(\alpha_i) &amp; -\sin(\alpha_i) &amp; 0 &amp; L_\tau\
\sin(\alpha_i) &amp;  \cos(\alpha_i) &amp; 0 &amp; 0\
0 &amp; 0 &amp;1 &amp; 0\
0 &amp; 0 &amp; 0&amp;1\
\end{array}\right)\
p_{i +1} &amp;=&amp; M_{i+1} \cdot  (0, 0, 0, 1)^T
\end{eqnarray}
Using these notations, the fitness function for a candidate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span> is the distance between the end of the last link and the target:
\begin{equation}
f(\mathbf{\alpha}, [L, \alpha_{\textrm{max}}]) = -\big|\big|p_d - T\big|\big|
\end{equation}
where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>α</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span></span> is the candidate solution, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">d</span></span></span></span> is the dimensionality of the domain and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span> the target. Each fitness evaluation requires only <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn><mi mathvariant="normal">.</mi><mn>5</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">3.5 \times 10^{-4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">3</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mbin">×</span><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord">−</span><span class="mord mathrm">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> seconds to be evaluated (in Python, Intel(R) Xeon(R) Silver 4110 CPU at 2.10GHz).</p>
<p>% timer for arm: 10k evals in  3.3780743051320314 =&gt; 1 eval = 3.5 \times 10^{-4}s
% timer for hexapod: 100 evals in 30 seconds : 0.3 s / eval</p>
<p>\label{sec:arm-baselines}
With an evaluation budget of 1 million, we compare Multi-task MAP-Elites to:
\begin{itemize}
\item Vanilla MAP-Elites (all tasks): each candidate solution is evaluated on each task and therefore competes in all the niches (each batch therefore requires <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mo>×</mo><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo>(</mo><mi>T</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">B \times card(T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mbin">×</span><span class="mord mathit">c</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">d</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mclose">)</span></span></span></span> calls to the fitness function, that is, the size of the batch times the number of tasks).
\item Vanilla MAP-Elites (random task): each candidate solution is evaluated on a random task and competes only for that task (in this case, the number of evaluations for a batch is equal to the size of the batch).
\item CMA-ES <dt-cite key="hansen2003reducing"></dt-cite>: an independent instance of CMA-ES is run for each task (all the CMA-ES instances run in parallel).
\item Random sampling: each candidate solution is generated randomly (no cross-over or mutation) and tested on a random task; the best solution is kept as the elite for each task.
\end{itemize}</p>
<p>We define 5000 tasks that are spread evenly using a centroidal Voronoi tesselation <dt-cite key="vassiliades2016scaling"></dt-cite> (they could also have been spread randomly or on a grid). MAP-Elites uses the line mutation operator introduced in <dt-cite key="vassiliades:hal-01764739"></dt-cite> (section \ref{sec:sota}, equation \ref{eq:line}). Each batch corresponds to 64 evaluations (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mo>=</mo><mn>6</mn><mn>4</mn></mrow><annotation encoding="application/x-tex">B=64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mrel">=</span><span class="mord mathrm">6</span><span class="mord mathrm">4</span></span></span></span>). We run 30 replicates for each approach to get statistics.</p>
<p>\subsection{Results}</p>
<p>The results (Fig. \ref{fig:results_arms}) show that Multi-Task MAP-Elites outperforms all the baselines. Looking at the generated maps (Fig. \ref{fig:results_arms}-B,D), we observe that CMA-ES leads to some &quot;noise&quot; (Fig. \ref{fig:results_arms}-C -- see especially on the top right of the map). This may be caused by the poor performance of some runs (since each run is independent, there is no knowledge transfer at all between tasks) and also, probably, by the fact that with a population of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span> (the default for CMA-ES in 10 dimensions) and 5000 tasks, only <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">0</span></span></span></span> generations can be run with the evaluation budget (therefore many runs may not have had a chance to converge). The map generated when we evaluate each solution on the 5000 tasks (Fig. \ref{fig:results_arms}-D, bottom) is smoother, but the quality of the solutions is much lower than in Multi-task MAP-Elites. This can be explained by the fact that only a few generations can be completed with 1 million evaluations: only 3 batches (192 solutions, since <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>6</mn><mn>4</mn><mo>×</mo><mn>5</mn><mn>0</mn><mn>0</mn><mn>0</mn><mo>=</mo><mn>3</mn><mn>2</mn><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">64\times5000=320,000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">6</span><span class="mord mathrm">4</span><span class="mbin">×</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span>) have been evaluated within the budget.</p>
<p>Contrary to classic MAP-Elites experiments, all the niches in the experiments conducted here were reachable by any candidate solution. As a result, all the approaches tested here were able to quickly fill all the niches, making map-coverage a moot point for comparison. We therefore focus our analysis on the mean fitness over the map (Fig. \ref{fig:results_arms}-E,F). Both random sampling and evaluation on all the tasks lead to low fitness values. MAP-Elites on random tasks performs as well as CMA-ES, which might be surprising at first since CMA-ES is one of the best known algorithms for continuous optimization. However, this good performance can be explained by the fact that even when MAP-Elites selects the task randomly, it creates new candidate solutions from the elites of the map: if the best solutions of all the niches share some genes (they use &quot;the same recipe&quot;), then they occupy the same &quot;elite hypervolume&quot; <dt-cite key="vassiliades:hal-01764739"></dt-cite> and the line mutation operator can leverage a good solution from one task to solve another one. Nevertheless, Multi-task MAP-Elites quickly outperforms (in a few hundreds of evaluations) both CMA-ES and MAP-Elites.</p>
<p>In order to investigate the influence of the bandit algorithm, we also ran Multi-task MAP-Elites with a fixed tournament size, using values ranging from 1 (equivalent to selecting a random task) to 5000 (equivalent to selecting the closest task). The results (Fig.\ref{fig:results_arms}-G,H) show that, a tournament that is too small (less than 50) does not allow the algorithm to reach the best mean fitness values. Conversely, a large tournament (more than 1000) slows down the algorithm significantly, but it does not prevent it from reaching the best fitness values. The bandit algorithm finds the best tradeoff as it is as good as the best tournament value.</p>
<p>\section{Six-legged Locomotion}</p>
<p>\begin{figure*}
\centering
\includegraphics[width=0.94\textwidth]{figures/hexapod/results_hexapod}
\caption{\label{fig:results_hexapod}Hexapod robot experiments. (A) The robot is parameterized by 12 values that correspond to the length of the 12 segments indicated by arrows. (B-D) Examples of randomly generated morphologies. (E) Mean fitness for all tasks with respect to the number of evaluations (20 replicates). The solid line represents the median over 20 replicates and the light zones the interquartile range. (F) Mean fitness value after 1 million evaluations. All the differences are statistically significant (Mann-Whitney U-test, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>&lt;</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>0</mn><mn>0</mn><mn>5</mn></mrow><annotation encoding="application/x-tex">p &lt; 0.0005</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mrel">&lt;</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span></span></span></span>). (G) Fitness of gaits generated by CMA-ES if given many more evaluations (here, 100,000) and a single task. Each line is an individual run and the thick black line is the median.}
\end{figure*}
\subsection{Methods}
To evaluate Multi-task Map-Elites in a more challenging scenario, we use a simulated 6-legged robot <dt-cite key="cully:hal-01158243,chatzilygeroudis:hal-01654641"></dt-cite> that is required to walk forward as fast as possible. The morphology of the 6-legged robot is parameterized by 12 values that correspond to a length change for each of the 12 main segments (2 segments for each leg, see Fig. \ref{fig:results_hexapod}-A). Each set of lengths defines a task since a specific gait is likely to be needed for a specific morphology, however, a given gait might work or be a good starting point for several morphologies.</p>
<p>The main differences from the previous experiments are that: (1) the problem is harder (experiments in this domain show that finding a good gait requires thousands of evaluations <dt-cite key="cully:hal-01158243"></dt-cite>), (2) there are more parameters to optimize (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn><mn>6</mn></mrow><annotation encoding="application/x-tex">36</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">3</span><span class="mord mathrm">6</span></span></span></span> versus <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span>), and (3) the tasks are defined by more parameters (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>2</mn></mrow><annotation encoding="application/x-tex">12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">2</span></span></span></span> versus <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span></span></span></span>), (4) the tasks are defined randomly instead of being spread with a centroidal Voronoi tesselation. Simulating a walking 6-legged robot for 3 seconds is about 3 orders of magnitude more computationally demanding than computing the forward kinematics of a planar arm.</p>
<p>Finding optimal gaits for many variants of the same morphology could be useful in future work for damage recovery. In particular, it was previously shown that a repertoire of diverse gaits generated for the same
morphology can be combined with Bayesian optimization to allow a 6-legged robot to recover from damage in a few minutes <dt-cite key="cully:hal-01158243,pautrat2017bayesian"></dt-cite>. Put differently, damage conditions were not explicitly anticipated but the diversity of gaits was enough to find compensatory gaits. By contrast, the repertoire generated with Multi-task MAP-Elites explicitly anticipates damage conditions (here, different lengths for the leg segments) --- which could help for recovery. Nevertheless, the same Bayesian optimization as in previous work <dt-cite key="cully:hal-01158243,pautrat2017bayesian"></dt-cite> can be applied to this problem as well.</p>
<p>Incidentally, searching for optimal gaits for a large set of morphlogies is an original approach to co-evolve gaits and morphology, which is a classic line of research in evolutionary robotics <dt-cite key="doncieux:hal-01131267"></dt-cite>. Thus, by looking at the highest-performing gaits in a map, we find the highest-performing morphology/gait pair.</p>
<p>The gaits being used here are generated by the same 36-dimen-sional controller used in previous work <dt-cite key="cully:hal-01158243,pautrat2017bayesian,chatzilygeroudis:hal-01654641"></dt-cite>. In a few words, the robot has 18 joints (3 per leg). 12 joints are explicitly controlled (2 per leg) and the last joint in each leg is equals to that for the second joint (so that the last segment stays mostly vertical). The trajectory of each joint is a periodic signal (a smoothed square wave) that is parameterized by a phase shift, an amplitude, and an offset. There are therefore 3 parameters for each of the 12 controlled joints.</p>
<p>The robot is simulated in Pybullet\footnote{Source code: \url{https://github.com/resibots/pyhexapod}}~<dt-cite key="coumans2016pybullet"></dt-cite>. In these simulations, the robot is initially located at the origin, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(0, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mclose">)</span></span></span></span>, and is supposed to move along the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>-axis.</p>
<p>The fitness function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mrow><mi>θ</mi></mrow><mo separator="true">,</mo><mrow><mi>τ</mi></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">f(\mathbf{\theta}, \mathbf{\tau})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">θ</span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.1132em;">τ</span></span><span class="mclose">)</span></span></span></span> is the distance covered along the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>-axis until one of the following conditions is met:
\begin{itemize}
\item the simulation lasts more than 3 simulated seconds;
\item the absolute value of the pitch or roll of the body exceeds <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>π</mi></mrow><mrow><mn>8</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\pi}{8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.695392em;"></span><span class="strut bottom" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">8</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">π</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span> (indicating that the body is not horizontal enough);
\item the absolute value of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span> position is above <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span> (indicating that the robot has deviated too much from a straight path).
\end{itemize}
Each fitness evaluation requires about <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mi mathvariant="normal">.</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">0.3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">3</span></span></span></span> seconds to be evaluated (in Python, Intel(R) Xeon(R) Silver 4110 CPU at 2.10GHz).</p>
<p>In these experiments, we generate 2000 random morphologies, that is, 2000 tasks. The distance between tasks is the Euclidean distance between their 12 parameters. As in the previous experiments with the kinematic arm, we use 1,000,000 evaluations and a batch size of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>6</mn><mn>4</mn></mrow><annotation encoding="application/x-tex">64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">6</span><span class="mord mathrm">4</span></span></span></span>. Besides the number of tasks and the dimensionality, all the parameters are the same as in the previous experiments. We replicate each experiment 20 times to gather statistics.</p>
<p>We use the same baselines as before (section \ref{sec:arm-baselines}): running 2000 instances of CMA-ES in parallel (one for each task), using MAP-Elites with random task assignment, and using MAP-Elites with an evaluation of each offspring on all the tasks.</p>
<p>\subsection{Results}
As with the kinematic arm experiments, the results show that Multi-task MAP-Elites outperforms the baselines (Fig. \ref{fig:results_hexapod}). MAP-Elites with random task assignment is competitive with Multi-task MAP-Elites, which confirms that MAP-Elites can leverage the elite hypervolume for multi-task optimization. Surprisingly, CMA-ES is outperformed by all the other approaches --- even MAP-Elites with evaluation on all the tasks. The most likely causes for this low performance are (1) with 2000 tasks and a default population of 14 (the population size computed by CMA-ES for 36 dimensions), only 500 evaluations are used for each instance, whereas benchmarks for black-box optimization usually use more than <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding="application/x-tex">10^6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">6</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> evaluations for a single optimization~<dt-cite key="hansen2010comparing"></dt-cite>); and (2) the 6-legged locomotion task is much harder for CMA-ES than the kinematic arm because the gradient is less smooth and requires a more global optimization.</p>
<p>\begin{figure*}
\centering
\includegraphics[width=0.95\textwidth]{figures/hexapod/hexapod_analysis}
\caption{\label{fig:analysis_hexapod}(A) Genomes of a typical map after 1 million evaluations. Each column is a parameter of the genome; the vertical coordinate corresponds to the parameter value, and the color to the fitness value. (B) Fitness of the top 5% of elites on all the tasks compared to the fitness of the elite for the task (&lt; 0 indicates that the elite in the map performs better than the top-5% elite; &gt; 0 indicates that the top-5% elite performs better than the current elite in the map).}
\end{figure*}</p>
<p>To better understand the performance of CMA-ES in our case, we ran 20 replicates of vanilla CMA-ES for 100,000 evaluations on a single task (randomly chosen). The results show that CMA-ES can find high-performing solutions, but there is a large variance between the runs, as only 4 replicates out of 20 found a fitness above 0.7 (the median mean value found by Multi-task MAP-Elites in 1 million evaluations). In addition, most replicates stop improving after about <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10,000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span> evaluations, which indicates a premature convergence. Overall, these results show that Multi-task MAP-Elites benefits from solving all the tasks simultaneously, both to avoid premature convergence and to find high-performing solutions faster. It should be noted that more recent versions of CMA-ES (e.g., Bipop CMA-ES) could perform better, but it is unlikely that they can find high-performing gaits in only 500 evaluations.</p>
<p>We analyzed the genomes of a typical map generated by Multi-task MAP-Elites with 1 million evaluations (Fig. \ref{fig:analysis_hexapod}-A). The plots show that the values for each parameter tend to be in a specific range, often around the parameters that correspond to the best fitness. For instance, in this map, there is no elite with a value around 0 for the first parameter, and most of the elites have a value between 0.6 and 1.0. This shows that the elites follow common patterns (at least in terms of ranges for each parameter), which explains why MAP-Elites and Multi-task MAP-Elites are effective: they can leverage these patterns to generate new individuals.</p>
<p>Lastly, we also checked that the tasks were different enough so that the best gait needs to be different for each task. To do so, we evaluated the fitness of the top 5% of elites (i.e., top-10 elites) on  all the tasks and we compared the obtained fitness with that for the elite found by Multi-task MAP-Elites for each task. A negative value means that the elite found by Multi-task MAP-Elites for this task is better than the top-5% elite, indicating that a simple copy of the elite to all the tasks would be ineffective. On the other hand, a positive value means that the top elite performs better than the elite found for that task. The results (Fig. \ref{fig:analysis_hexapod}-B) show that the fitness difference for these elites all lie at about -0.4, indicating that the best elites do not perform well on the other tasks. A corollary is that the best fitness values of the map are likely to correspond to better morphology (e.g., symmetric morphologies), and not to a better optimization of the gait. Our preliminary analysis tends to show that the best morphology corresponds to large middle legs, and short front and back legs.</p>
<p>\section{Conclusion}
This paper shows that there is a strong connection between quality diversity algorithms and multi-task optimization, especially when a few thousands tasks are considered. MAP-Elites with random task assignment is a straightforward algorithm and performs surprisingly well in the two domains that we considered: the performance is similar to CMA-ES (a conceptually much more complex algorithm) in the 10-dimensional arm / 5000 case and much better than CMA-ES in the hexapod case. Our interpretation is that MAP-Elites with the line mutation operator effectively exploits the elite hypervolume to fill niches with high-performing solutions. Put differently, when the tasks are assigned randomly, MAP-Elites exploits the similarity between the tasks implicitly.</p>
<p>Nevertheless, the bias introduced by Multi-task MAP-Elites improves the results substantially and does not add any hyperparameter, thanks to the bandit algorithm. A natural follow-up will be to investigate whether maps generated by varying the morphology of robots (i.e., what is done here) are better for damage recovery than maps generated by encouraging different behaviors with the same morphology (i.e., what has been done so far, for example in <dt-cite key="cully:hal-01158243"></dt-cite>).</p>
<p>The main drawbacks of Multi-task MAP-Elites are that it assumes that (1) there is at least few hundred tasks (with fewer tasks, there is not enough diversity for MAP-Elites to work), and (2) we have access to a distance function between tasks. In complex cases, for instance, game levels, this distance might not be available\footnote{Some work has been published recently for defining or learning distance functions between game levels <dt-cite key="smith2010analyzing,summerville2018expanding,justesen2018illuminating"></dt-cite>, although we did not test them in combination with Multi-Task MAP-Elites so far.}, which prevents a direct use of Multi-task MAP-Elites. In these cases, using MAP-Elites with random task assignment is a viable option. Still, future work should investigate how to discover or learn this distance function during evolution~<dt-cite key="smith2010analyzing,summerville2018expanding,justesen2018illuminating"></dt-cite>.</p>
<p>Overall, future work should further explore the connections between QD algorithms and multi-task optimization, both to import novel ideas to QD algorithms and to propose new algorithms for the multi-task optimization and learning communities.</p>
<p>\section*{Source code}
Reference implementation of Multi-task MAP-Elites (Python3): \url{https://github.com/resibots/pymap_elites}.\
Experiments: \url{https://github.com/resibots/2020_mouret_gecco}</p>
<p>\section*{Acknowledgements}
This work received funding from the European Research Council (ERC) under the European Union's Horizon 2020 research and innovation programme (GA no. 637972,
project &quot;ResiBots&quot;) and the Lifelong Learning Machines program (L2M) from DARPA/MTO under Contract No. FA8750-18-C-0103.</p>
<p>\bibliographystyle{ACM-Reference-Format}
\bibliography{multitask.bib}</p>
<p>\end{document}</p>
</dt-article>
<dt-appendix>
<h2>Acknowledgements</h2>
<p>This article was prepared using the <a href="https://distill.pub">Distill</a> <a href="https://github.com/distillpub/template">template</a>.</p>
<h3 id="citation">Citation</h3>
<p>For attribution in academic contexts, please cite this work as</p>
<pre class="citation short">JB Mouret and G. Maguire, "Quality Diversity for Multitask Optimization", Proc. of GECCO. 2020.</pre>
<p>BibTeX citation</p>
<pre class="citation long">@inproceedings{mouret2020,
  author = {Jean-Baptiste Mouret and Glenn Maguire},
  title  = {uality Diversity for Multitask Optimization},
  eprint = {arXiv:2003.04407},
  booktitle = {Proceedings of GECCO},
  url    = {https://resibots.eu/2020_mouret_gecco},
  note   = "\url{https://resibots.eu/2020_mouret_gecco}",
  year   = {2020}
}</pre>
<h2>Open Source Code</h2>
</dt-appendix>
<script type="text/bibliography">

@inproceedings{gravina2019procedural,
  title={Procedural content generation through quality diversity},
  author={Gravina, Daniele and Khalifa, Ahmed and Liapis, Antonios and Togelius, Julian and Yannakakis, Georgios N},
  booktitle={IEEE Conference on Games (CoG)},
  pages={1--8},
  year={2019},
  organization={IEEE}
}

@article{adams2000genome,
  title={The genome sequence of Drosophila melanogaster},
  author={Adams, Mark D and Celniker, Susan E and Holt, Robert A and Evans, Cheryl A and Gocayne, Jeannine D and Amanatides, Peter G and Scherer, Steven E and Li, Peter W and Hoskins, Roger A and Galle, Richard F and others},
  journal={Science},
  volume={287},
  number={5461},
  pages={2185--2195},
  year={2000},
  publisher={American Association for the Advancement of Science}
}

@article{pearce2018continuous,
  title={Continuous multi-task Bayesian Optimisation with correlation},
  author={Pearce, Michael and Branke, Juergen},
  journal={European Journal of Operational Research},
  volume={270},
  number={3},
  pages={1074--1085},
  year={2018},
  publisher={Elsevier}
}

@article{karafotias2014parameter,
  title={Parameter control in evolutionary algorithms: Trends and challenges},
  author={Karafotias, Giorgos and Hoogendoorn, Mark and Eiben, {\'A}goston E},
  journal={IEEE Transactions on Evolutionary Computation},
  volume={19},
  number={2},
  pages={167--187},
  year={2014},
  publisher={IEEE}
}
@article{eiben1999parameter,
  title={Parameter control in evolutionary algorithms},
  author={Eiben, {\'A}goston E and Hinterding, Robert and Michalewicz, Zbigniew},
  journal={IEEE Transactions on Evolutionary Computation},
  volume={3},
  number={2},
  pages={124--141},
  year={1999},
  publisher={IEEE}
}


@article{mouret2015illuminating,
  title={Illuminating search spaces by mapping elites},
  author={Mouret, Jean-Baptiste and Clune, Jeff},
  journal={arXiv preprint},
  year={2015},
  url={http://arxiv.org/abs/1504.04909},
  keywords={resilience, evolution, illumination}
}

% journals
@article{koos:hal-00932862,
  TITLE = {{Fast Damage Recovery in Robotics with the T-Resilience Algorithm}},
  AUTHOR = {Koos, Sylvain and Cully, Antoine and Mouret, Jean-Baptiste},
  JOURNAL = {{International Journal of Robotics Research (IJRR)}},
  PUBLISHER = {{SAGE Publications}},
  VOLUME = {32},
  NUMBER = {14},
  PAGES = {1700-1723},
  YEAR = {2013},
  MONTH = Dec,
  DOI = {10.1177/0278364913499192},
  URL = {https://hal.archives-ouvertes.fr/hal-00932862},
  PDF = {https://hal.archives-ouvertes.fr/hal-00932862/document},
  HAL_ID = {hal-00932862},
  HAL_VERSION = {v1},
  keywords={resilience,robotics, learning,reality-gap},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%
@article{doncieux:hal-01150254,
  TITLE = {{Beyond black-box optimization: a review of selective pressures for evolutionary robotics}},
  AUTHOR = {Doncieux, Stephane and Mouret, Jean-Baptiste},
  JOURNAL = {{Evolutionary Intelligence}},
  VOLUME = {7},
  NUMBER = {2},
  PAGES = {71-93},
  YEAR = {2014},
  MONTH = Jul,
  DOI = {10.1007/s12065-014-0110-x},
  URL = {http://hal.upmc.fr/hal-01150254},
  HAL_ID = {hal-01150254},
  HAL_VERSION = {v1},
  keywords={evolution, diversity},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%
@article{tarapore:hal-01150508,
  TITLE = {{Evolvability signatures of generative encodings: Beyond standard performance benchmarks}},
  AUTHOR = {Tarapore, Danesh and Mouret, Jean-Baptiste},
  JOURNAL = {{Information Sciences}},
  PUBLISHER = {{Elsevier}},
  VOLUME = {313},
  PAGES = {43-61},
  YEAR = {2015},
  MONTH = Aug,
  DOI = {10.1016/j.ins.2015.03.046},
  URL = {http://hal.upmc.fr/hal-01150508},
  HAL_ID = {hal-01150508},
  HAL_VERSION = {v1},
  keywords={evolution, encodings},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%
@article{cully:hal-01095543,
  TITLE = {{Evolving a Behavioral Repertoire for a Walking Robot}},
  AUTHOR = {Cully, Antoine and Mouret, Jean-Baptiste},
  JOURNAL = {{Evolutionary Computation}},
  PUBLISHER = {{MIT Press}},
  VOLUME = {24},
  NUMBER = {1},
  PAGES = {59-88},
  YEAR = {2016},
  DOI = {10.1162/EVCO\_a\_00143},
  URL = {https://hal.inria.fr/hal-01095543},
  PDF = {https://hal.inria.fr/hal-01095543/document},
  video={https://www.youtube.com/watch?v=1xmGGm6eb9I},
  HAL_ID = {hal-01095543},
  HAL_VERSION = {v1},
  doi={10.1145/2463372.2463399},
  keywords={robotics, evolution, resilience, reality-gap, diversity, illumination},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}

@article{koos:hal-00687617,
  TITLE = {{The Transferability Approach: Crossing the Reality Gap in Evolutionary Robotics}},
  AUTHOR = {Koos, Sylvain and Mouret, Jean-Baptiste and Doncieux, St{\'e}phane},
  JOURNAL = {{IEEE Transactions on Evolutionary Computation (TEC)}},
  PUBLISHER = {{IEEE}},
  volume={17},
  number={1},
  pages={122--145},
  year={2013},
  DOI = {10.1109/TEVC.2012.2185849},
  URL = {https://hal.archives-ouvertes.fr/hal-00687617},
  PDF = {https://hal.archives-ouvertes.fr/hal-00687617/document},
  HAL_ID = {hal-00687617},
  HAL_VERSION = {v1},
  video={https://www.youtube.com/watch?v=qDPbXvADyio https://www.youtube.com/watch?time_continue=110&v=9LW1tjFVyLY},
  keywords={robotics, evolution, reality-gap},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}


@article{mouret:hal-00687609,
  TITLE = {{Encouraging Behavioral Diversity in Evolutionary Robotics: an Empirical Study}},
  AUTHOR = {Mouret, Jean-Baptiste and Doncieux, St{\'e}phane},
  JOURNAL = {{Evolutionary Computation}},
  PUBLISHER = {MIT Press},
  VOLUME = {20},
  NUMBER = {1},
  PAGES = {91-133},
  YEAR = {2012},
  DOI = {10.1162/EVCO\_a\_00048},
  PDF = {https://hal.archives-ouvertes.fr/hal-00687609/document},
  HAL_ID = {hal-00687609},
  HAL_VERSION = {v1},
  keywords={evolution, diversity},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
@article{reuillon:hal-01118936,
  TITLE = {A New Method to Evaluate Simulation Models: The Calibration Profile (CP) Algorithm},
  AUTHOR = {Reuillon, Romain and Schmitt, Clara and De Aldama, Ricardo and Mouret, Jean-Baptiste},
  JOURNAL = {{Journal of Artificial Societies and Social Simulation}},
  PUBLISHER = {{SimSoc Consortium}},
  VOLUME = {18},
  NUMBER = {1},
  URL = {http://jasss.soc.surrey.ac.uk/18/1/12.html},
  YEAR = {2015},
  MONTH = Jan,
  doi = {10.18564/jasss.2675},
  keywords={illumination,evolution},
  HAL_ID = {hal-01118936},
  HAL_VERSION = {v1},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
  keywords={evolution},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%
@article{doncieux:hal-01131267,
  TITLE = {{Evolutionary robotics: what, why, and where to}},
  AUTHOR = {Doncieux, Stephane and Bredeche, Nicolas and Mouret, Jean-Baptiste and Eiben, Gusz AE},
  JOURNAL = {{Frontiers in Robotics and AI}},
  PUBLISHER = {{Frontiers}},
  PAGES = {10.3389/frobt.2015.00004},
  YEAR = {2015},
  MONTH = Mar,
  DOI = {10.3389/frobt.2015.00004},
  PDF = {https://hal.archives-ouvertes.fr/hal-01131267/document},
  HAL_ID = {hal-01131267},
  HAL_VERSION = {v1},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
  keywords={evolution},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}

@article{cully:hal-01158243,
  TITLE = {{Robots that can adapt like animals}},
  AUTHOR = {Cully, Antoine and Clune, Jeff and Tarapore, Danesh and Mouret, Jean-Baptiste},
  JOURNAL = {{Nature}},
  PUBLISHER = {{Nature Publishing Group}},
  VOLUME = {521},
  NUMBER = {7553},
  PAGES = {503-507},
  YEAR = {2015},
  MONTH = May,
  DOI = {10.1038/nature14422},
  PDF = {https://hal.archives-ouvertes.fr/hal-01158243/document},
  SRC={https://github.com/resibots/cully_2015_nature},
  video={https://www.youtube.com/watch?v=T-c17RKh3uE https://www.youtube.com/watch?v=IHQgnpSphEI},
  HAL_ID = {hal-01158243},
  HAL_VERSION = {v1},
  keywords={robotics, evolution, resilience, reality-gap, learning, illumination},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%
@article{olavellefsen:hal-01138901,
  TITLE = {{Neural Modularity Helps Organisms Evolve to Learn New Skills without Forgetting Old Skills}},
  AUTHOR = {Ellefsen, Kai Olav and Mouret, Jean-Baptiste and Clune, Jeff},
  JOURNAL = {{PLoS Computational Biology}},
  PUBLISHER = {{Public Library of Science}},
  VOLUME = {11},
  NUMBER = {4},
  PAGES = {e1004128},
  YEAR = {2015},
  DOI = {10.1371/journal.pcbi.1004128.s009},
  URL = {https://hal.archives-ouvertes.fr/hal-01138901},
  PDF = {https://hal.archives-ouvertes.fr/hal-01138901/document},
  VIDEO={https://www.youtube.com/watch?v=6PlvyWQUQu8},
  HAL_ID = {hal-01138901},
  HAL_VERSION = {v1},
  keywords={evolution, biology, plasticity},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}

@article{mengistu:hal-01330681,
  TITLE = {{The Evolutionary Origins of Hierarchy}},
  AUTHOR = {Mengistu, Henok and Huizinga, Joost and Mouret, Jean-Baptiste and Clune, Jeff},
  JOURNAL = {{PLoS Computational Biology}},
  PUBLISHER = {{Public Library of Science}},
  VOLUME = {12},
  NUMBER = {6},
  YEAR = {2016},
  DOI = {10.1371/journal.pcbi.1004829.s021},
  URL = {https://hal.inria.fr/hal-01330681},
  PDF = {https://hal.inria.fr/hal-01330681/document},
  HAL_ID = {hal-01330681},
  HAL_VERSION = {v1},
  keywords={evolution, biology},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
@article{jolly:hal-01274231,
  TITLE = {{Animal-to-robot social attachment: initial requisites in a gallinaceous bird}},
  AUTHOR = {Jolly, Lucile and Pittet, Florent and Caudal, Jean-Pierre and Mouret, Jean-Baptiste and Houdelier, Cécilia and Lumineau, Sophie and de Margerie, Emmanuel},
  JOURNAL = {{Bioinspiration and Biomimetics}},
  PUBLISHER = {{IOP Publishing}},
  VOLUME = {11},
  NUMBER = {1},
  PAGES = {016007},
  YEAR = {2016},
  DOI = {10.1088/1748-3190/11/1/016007},
  URL = {https://hal-univ-rennes1.archives-ouvertes.fr/hal-01274231},
  HAL_ID = {hal-01274231},
  HAL_VERSION = {v1},
  keywords={none},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}

@ARTICLE{2013ACLI2788,
	CATEGORY = {ACLI},
	AUTHOR = {Clune*, J. and Mouret, J.-B. and Lipson, H.},
	TITLE = {The evolutionary origins of modularity},
	YEAR = {2013},
	PDF = {http://www.isir.upmc.fr/files/2013ACLI2788.pdf},
	PAGES = {20122863},
	JOURNAL = {Proceedings of the Royal Society B},
	VOLUME = {280 (* J. Clune and J.-B. Mouret contributed equally to this work)},
  video={https://www.youtube.com/watch?v=Rgq7Jzsw8vw},
	DOI = {10.1098/rspb.2012.2863},
  keywords={evolution, biology, modularity},
  X-INTERNATIONAL-AUDIENCE = {yes},
	X-EDITORIAL-BOARD = {yes},
	X-SCIENTIFIC-POPULARIZATION = {no},

}
@ARTICLE{2013ACLI2965,
	CATEGORY = {ACLI},
	AUTHOR = {Tonelli, P. and Mouret, J.-B.},
	TITLE = {On the Relationships between Generative Encodings, Regularity, and Learning Abilities when Evolving Plastic Artificial Neural Networks},
	YEAR = {2013},
	PDF = {http://www.isir.upmc.fr/files/2013ACLI2965.pdf},
	PAGES = {e79138},
	JOURNAL = {PLoS One},
	VOLUME = {8},
	NUMBER = {11},
	MONTH = {November},
	DOI = {10.1371/journal.pone.0079138},
  keywords={evolution,biology,plasticity,encodings},
  X-INTERNATIONAL-AUDIENCE = {yes},
	X-EDITORIAL-BOARD = {yes},
	X-SCIENTIFIC-POPULARIZATION = {no},
}
@ARTICLE{2004ACLI1813,
	CATEGORY = {ACLI},
	AUTHOR = {Geraud, T. and Mouret, J.-B.},
	TITLE = {Fast road network extraction in satellite images using mathematical morphology and Markov random fields},
	YEAR = {2004},
	PUBLISHER = {Hindawi Publishing Corp.},
	PAGES = {2503--2514},
	JOURNAL = {EURASIP Journal of Applied Signal Processing},
	MONTH = {January},
		X-INTERNATIONAL-AUDIENCE = {yes},
	X-EDITORIAL-BOARD = {yes},
	X-SCIENTIFIC-POPULARIZATION = {no},
	doi={10.1155/S1110865704409093},
  keywords={image},
  X-INTERNATIONAL-AUDIENCE = {yes},
	X-EDITORIAL-BOARD = {yes},
	X-SCIENTIFIC-POPULARIZATION = {no},
}

@ARTICLE{2007ACLI732,
	CATEGORY = {ACLI},
	AUTHOR = {de Margerie, E. and Mouret, J.-B. and Doncieux, S. and Meyer, J.-A.},
	TITLE = {Artificial evolution of the morphology and kinematics in a flapping-wing mini UAV},
	YEAR = {2007},
	KEYWORD = {evolution, flapping-wing},
	PDF = {http://www.isir.upmc.fr/files/2007ACLI732.pdf},
	PAGES = {65--82},
	JOURNAL = {Bioinspiration \& Biomimetics},
	HTTP = {http://stacks.iop.org/1748-3190/2/65},
	VOLUME = {2},
	doi={10.1088/1748-3182/2/4/002},
  keywords={evolution},
  X-INTERNATIONAL-AUDIENCE = {yes},
	X-EDITORIAL-BOARD = {yes},
	X-SCIENTIFIC-POPULARIZATION = {no},
}

@ARTICLE{2008ACLI931,
	CATEGORY = {ACLI},
	AUTHOR = {Mouret, J.-B. and Doncieux, S.},
	TITLE = {MENNAG: a modular, regular and hierarchical encoding for neural-networks based on attribute grammars},
	YEAR = {2008},
	PDF = {http://www.isir.upmc.fr/files/2008ACLI931.pdf},
	PAGES = {187--207},
	JOURNAL = {Evolutionary Intelligence},
	HTTP = {http://www.springerlink.com/content/81288r5407701177/},
	VOLUME = {1},
	NUMBER = {3},
	doi={10.1007/s12065-008-0015-7},
  keywords={evolution, encodings},
	X-INTERNATIONAL-AUDIENCE = {yes},
	X-EDITORIAL-BOARD = {yes},
	X-SCIENTIFIC-POPULARIZATION = {no},
}

@article{vassiliades2016scaling,
  title={Using Centroidal {Voronoi} Tessellations to Scale Up the Multi-dimensional Archive of Phenotypic Elites Algorithm},
  author={Vassiliades, Vassilis and Chatzilygeroudis, Konstantinos and Mouret, Jean-Baptiste},
  journal={IEEE Transactions on Evolutionary Computation},
  year={2017},
  doi={10.1109/TEVC.2017.2735550},
  src={https://github.com/resibots/vassiliades_2017_cvt_map_elites},
  pdf={https://hal.inria.fr/hal-01630627/file/ieee_tec_voronoi_map_elites.pdf},
  keywords={evolution,illumination},
  X-END={xx}
}

@article{morishima:hal-01630260,
  TITLE = {{Discovery of a big void in Khufu's Pyramid by observation of cosmic-ray muons}},
  AUTHOR = {Morishima, Kunihiro and Kuno, Mitsuaki and Nishio, Akira and Kitagawa, Nobuko and Manabe, Yuta and Moto, Masaki and Takasaki, Fumihiko and Fujii, Hirofumi and Satoh, Kotaro and Kodama, Hideyo and Hayashi, Kohei and Odaka, Shigeru and Procureur, S{\'e}bastien and Atti{\'e}, David and Bouteille, Simon and Calvet, Denis and Filosa, Christopher and Magnier, Patrick and Mandjavidze, Irakli and Riallot, Marc and Marini, Benoit and Gable, Pierre and Date, Yoshikatsu and Sugiura, Makiko and Elshayeb, Yasser and Elnady, Tamer and Ezzy, Mustapha and Guerriero, Emmanuel and Steiger, Vincent and Serikoff, Nicolas and Mouret, Jean-Baptiste and Charl{\`e}s, Bernard and Helal, Hany and Tayoubi, Mehdi},
  URL = {https://hal.inria.fr/hal-01630260},
  JOURNAL = {{Nature}},
  PUBLISHER = {{Nature Publishing Group}},
  PAGES = {1-13},
  YEAR = {2017},
  MONTH = Nov,
  DOI = {10.1038/nature24647},
  PDF = {https://hal.inria.fr/hal-01630260/file/ScanPyramids.pdf},
  keywords={archeo},
  HAL_ID = {hal-01630260},
  HAL_VERSION = {v2},
}

@article{rieffel:hal-01631648,
  TITLE = {{Introduction to the Evolution of Physical Systems}},
  AUTHOR = {Rieffel, John and Mouret, Jean-Baptiste and Bredeche, Nicolas and Haasdijk, Evert},
  URL = {https://www.mitpressjournals.org/doi/abs/10.1162/ARTL_e_00232},
  JOURNAL = {{Artificial Life}},
  PUBLISHER = {{Massachusetts Institute of Technology Press (MIT Press)}},
  VOLUME = {23},
  NUMBER = {2},
  PAGES = {119 - 123},
  YEAR = {2017},
  MONTH = May,
  keywords={evolution},
  DOI = {10.1162/ARTL\_e\_00232},
  PDF = {https://hal.inria.fr/hal-01631648/file/introduction-evolution-physical%281%29.pdf},
  HAL_ID = {hal-01631648},
  HAL_VERSION = {v1},
}

@article{chatzilygeroudis:hal-01654641,
  TITLE = {{Reset-free Trial-and-Error Learning for Robot Damage Recovery}},
  AUTHOR = {Chatzilygeroudis, Konstantinos and Vassiliades, Vassilis and Mouret, Jean-Baptiste},
  JOURNAL = {{Robotics and Autonomous Systems}},
  PUBLISHER = {{Elsevier}},
  PAGES = {1-19},
  YEAR = {2017},
  DOI = {10.1016/j.robot.2017.11.010},
  keywords={resilience, robotics},
  PDF = {https://hal.inria.fr/hal-01654641/file/ral-2.pdf},
  video={https://youtu.be/IqtyHFrb3BU},
  src={https://github.com/resibots/chatzilygeroudis_2018_rte},
  HAL_ID = {hal-01654641},
  HAL_VERSION = {v2},
}

@article{rieffel2017,
  title={Adaptive and Resilient Soft Tensegrity Robots},
  author={Rieffel*, John and Mouret*, Jean-Baptiste},
  journal={Soft Robotics},
  year={2018},
  volume={(* J. Rieffel and J.-B. Mouret contributed equally to this work)},
  video={https://www.youtube.com/watch?v=SuLQDhrk9tQ&feature=youtu.be},
  data={TODO},
  doi={https://doi.org/10.1089/soro.2017.0066},
  keywords={resilience, learning, reality-gap},
  HAL_ID={}
}


@article{gaier2018,
  TITLE = {Data-Efficient Design Exploration through Surrogate-Assisted Illumination},
  AUTHOR = {Gaier, Adam and Asteroth, Alexander and Mouret, Jean-Baptiste},
  JOURNAL = {Evolutionary Computation},
  PUBLISHER = {{MIT Press}},
  YEAR = {2018},
  pdf={https://hal.inria.fr/hal-01817505/document},
  DOI = {10.1162/evco\_a\_00231},
  keywords={robotics, evolution},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
@article{cully2018limbo,
    title={{Limbo: A Flexible High-performance Library for Gaussian Processes modeling and Data-Efficient Optimization}},
    author={Cully, A. and Chatzilygeroudis, K. and Allocati, F.  and Mouret, J.-B.},
    year={2018},
    journal={{The Journal of Open Source Software}},
    publisher={The Open Journal},
    volume={3},
    number={26},
    pages={545},
    doi={10.21105/joss.00545},
    keywords={resilience, learning},
    X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},

}
@article{howard2019evolving,
  title={Evolving embodied intelligence from materials to machines},
  author={Howard, D and Eiben, Agoston E and Kennedy, Danielle Frances and Mouret, Jean-Baptiste and Valencia, Philip and Winkler, Dave},
  journal={Nature Machine Intelligence},
  volume={1},
  number={1},
  pages={12},
  year={2019},
  publisher={Nature Publishing Group},
  pdf={https://arxiv.org/pdf/1901.05704},
  keywords={evolution},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
}


@article{chatzilygeroudis2018survey,
  title={A survey on policy search algorithms for learning robot controllers in a handful of trials},
  author={Chatzilygeroudis, Konstantinos and Vassiliades, Vassilis and Stulp, Freek and Calinon, Sylvain and Mouret, Jean-Baptiste},
  journal={IEEE Transactions on Robotics},
  year={2019},
  pdf={https://arxiv.org/pdf/1807.02303},
  keywords={resilience, learning}
}

@article{lehman2018surprising,
  title={The surprising creativity of digital evolution: A collection of anecdotes from the evolutionary computation and artificial life research communities},
  author={Lehman, Joel and others},
  journal={Artificial Life},
  year={2020},
  keywords={evolution, illumination},
  pdf={https://arxiv.org/pdf/1803.03453},
  X-INTERNATIONAL-AUDIENCE  = {yes},
  X-EDITORIAL-BOARD = {yes},
}


% conferences
@inproceedings{mouret:hal-00473147,
  TITLE = {{Overcoming the bootstrap problem in evolutionary robotics using behavioral diversity}},
  AUTHOR = {Mouret, Jean-Baptiste and Doncieux, St{\'e}phane},
  BOOKTITLE = {{11th IEEE Congress on Evolutionary Computation (CEC'09)}},
  ADDRESS = {Trondheim, Norway},
  PUBLISHER = {{IEEE}},
  PAGES = {1161--1168},
  YEAR = {2009},
  PDF = {https://hal.archives-ouvertes.fr/hal-00473147/document},
  HAL_ID = {hal-00473147},
  HAL_VERSION = {v1},
  doi={10.1109/CEC.2009.4983077},
  keywords={evolution, diversity},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%
@inproceedings{koos:hal-00473153,
  TITLE = {{Automatic system identification based on coevolution of models and tests}},
  AUTHOR = {Koos, Sylvain and Mouret, Jean-Baptiste and Doncieux, St{\'e}phane},
  BOOKTITLE = {{11th IEEE Congress on Evolutionary Computation (CEC'09)}},
  ADDRESS = {Trondheim, Norway},
  PUBLISHER = {{IEEE}},
  PAGES = {560--567},
  YEAR = {2009},
  URL = {https://hal.archives-ouvertes.fr/hal-00473153},
  PDF = {https://hal.archives-ouvertes.fr/hal-00473153/document},
  HAL_ID = {hal-00473153},
  HAL_VERSION = {v1},
  doi={10.1109/CEC.2009.4982995},
  keywords={evolution, reality-gap},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%
@inproceedings{mouret:hal-00473132,
  TITLE = {{Using Behavioral Exploration Objectives to Solve Deceptive Problems in Neuro-evolution}},
  AUTHOR = {Mouret, Jean-Baptiste and Doncieux, St{\'e}phane},
  BOOKTITLE = {Genetic and evolutionary computation},
  ADDRESS = {Montr{\'e}al, Canada},
  PUBLISHER = {{ACM}},
  PAGES = {627--634},
  YEAR = {2009},
  DOI = {10.1145/1569901.1569988},
  PDF = {https://hal.archives-ouvertes.fr/hal-00473132/document},
  HAL_ID = {hal-00473132},
  HAL_VERSION = {v1},
  keywords={evolution, diversity},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},

}
 %%
@inproceedings{mouret:hal-00473135,
  TITLE = {{Evolving modular neural-networks through exaptation}},
  AUTHOR = {Mouret, Jean-Baptiste and Doncieux, St{\'e}phane},
  BOOKTITLE = {{11th Congress on Evolutionary Computation (CEC'09)} \textbf{(Best Student Paper)}},
  ADDRESS = {Trondheim, Norway},
  PUBLISHER = {{IEEE}},
  PAGES = {1570--1577},
  YEAR = {2009},
  URL = {https://hal.archives-ouvertes.fr/hal-00473135},
  PDF = {https://hal.archives-ouvertes.fr/hal-00473135/document},
  HAL_ID = {hal-00473135},
  HAL_VERSION = {v1},
  doi = {10.1109/CEC.2009.4983129},
  keywords={evolution, diversity},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%

@inproceedings{koos:hal-00633927,
  TITLE = {{Crossing the Reality Gap in Evolutionary Robotics by Promoting Transferable Controllers}},
  AUTHOR = {Koos, Sylvain and Mouret, Jean-Baptiste and Doncieux, St{\'e}phane},
  BOOKTITLE = {The 12th Annual conference on Genetic and evolutionary computation {(GECCO'10)}},
  ADDRESS = {United States},
  PUBLISHER = {{ACM}},
  PAGES = {119-126},
  YEAR = {2010},
  MONTH = Jul,
  URL = {https://hal.archives-ouvertes.fr/hal-00633927},
  PDF = {https://hal.archives-ouvertes.fr/hal-00633927/document},
  HAL_ID = {hal-00633927},
  HAL_VERSION = {v1},
  keywords={evolution, reality-gap},
  doi={10.1145/1830483.1830505},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%
@inproceedings{pinville:hal-00633928,
  TITLE = {{How to Promote Generalisation in Evolutionary Robotics: the ProGAb Approach}},
  AUTHOR = {Pinville, Tony and Koos, Sylvain and Mouret, Jean-Baptiste and Doncieux, St{\'e}phane},
  BOOKTITLE = {The 13th Annual conference on Genetic and evolutionary computation ({GECCO'11})},
  ADDRESS = {Ireland},
  PUBLISHER = {{ACM}},
  PAGES = {259-266},
  YEAR = {2011},
  MONTH = Jul,
  DOI = {10.1145/2001576.2001612},
  URL = {https://hal.archives-ouvertes.fr/hal-00633928},
  NOTE = {Consultable sur ACM Digital Library},
  PDF = {https://hal.archives-ouvertes.fr/hal-00633928/document},
  HAL_ID = {hal-00633928},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
  keywords={evolution}
}

@inproceedings{koos:hal-00633930,
  TITLE = {{Online Discovery of Locomotion Modes for Wheel-Legged Hybrid Robots: a Transferability-based Approach}},
  AUTHOR = {Koos, Sylvain and Mouret, Jean-Baptiste},
  BOOKTITLE = {{14th International Conference on Climbing and Walking Robots (CLAWAR)}. \textbf{Highly Recommended Paper, category ``control of CLAWAR''}},
  ADDRESS = {Paris, France},
  PAGES = {70-77},
  YEAR = {2011},
  MONTH = Sep,
  URL = {https://hal.archives-ouvertes.fr/hal-00633930},
  PDF = {https://hal.archives-ouvertes.fr/hal-00633930/document},
  doi={10.1142/9789814374286_0008},
  keywords={evolution, resilience, learning, reality-gap},
  HAL_ID = {hal-00633930},
  video={https://www.youtube.com/watch?v=DVjhA6QKxXo https://www.youtube.com/watch?v=6GcQvyx9hwo https://www.youtube.com/watch?v=sIl75Pb_Pnw},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {no},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},

}

@inproceedings{terekhov:hal-00687630,
  TITLE = {{Stochastic optimization of a chain sliding mode controller for the mobile robot maneuvering}},
  AUTHOR = {Terekhov, Alexander and Mouret, Jean-Baptiste and Grand, Christophe},
  BOOKTITLE = {{International Conference on Intelligent Robots and Systems (IROS)}},
  ADDRESS = {San Francisco, United States},
  PAGES = {4360-4365},
  YEAR = {2011},
  publisher={IEEE},
  keywords={learning, robotics},
  DOI = {10.1109/IROS.2011.6094956},
  URL = {https://hal.archives-ouvertes.fr/hal-00687630},
  PDF = {https://hal.archives-ouvertes.fr/hal-00687630/document},
  HAL_ID = {hal-00687630},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%
@inproceedings{mouret:hal-00687639,
  TITLE = {{Importing the Computational Neuroscience Toolbox into Neuro-Evolution---Application to Basal Ganglia}},
  AUTHOR = {Mouret, Jean-Baptiste and Doncieux, St{\'e}phane and Girard, Beno{\^i}t},
  BOOKTITLE = {The 12th Annual conference on Genetic and evolutionary computation {(GECCO'10)}},
  ADDRESS = {United States},
  publisher={{ACM}},
  PAGES = {587-594},
  YEAR = {2010},
  DOI = {10.1145/1830483.1830592},
  URL = {https://hal.archives-ouvertes.fr/hal-00687639},
  PDF = {https://hal.archives-ouvertes.fr/hal-00687639/document},
  keywords={evolution, biology, encodings},
  HAL_ID = {hal-00687639},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%
@inproceedings{doncieux:hal-00687641,
  TITLE = {{Behavioral diversity measures for Evolutionary Robotics}},
  AUTHOR = {Doncieux, St{\'e}phane and Mouret, Jean-Baptiste},
  BOOKTITLE = {12th IEEE Congress on Evolutionary Computation {(CEC'10)}},
  publisher={{IEEE}},
  ADDRESS = {Spain},
  PAGES = {1303-1310},
  YEAR = {2010},
  DOI = {10.1109/CEC.2010.5586100WCCI},
  URL = {https://hal.archives-ouvertes.fr/hal-00687641},
  PDF = {https://hal.archives-ouvertes.fr/hal-00687641/document},
  keywords={evolution, diversity},
  HAL_ID = {hal-00687641},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}

@inproceedings{tonelli:hal-00687621,
  TITLE = {{On the Relationships between Synaptic Plasticity and Generative Systems.}},
  AUTHOR = {Tonelli, Paul and Mouret, Jean-Baptiste},
  BOOKTITLE = {The 13th Annual conference on Genetic and evolutionary computation {(GECCO'11)}},
  PAGES = {1531-1538},
  YEAR = {2011},
  publisher={{ACM}},
  DOI = {10.1145/2001576.2001782},
  URL = {https://hal.archives-ouvertes.fr/hal-00687621},
  PDF = {https://hal.archives-ouvertes.fr/hal-00687621/document},
  keyworks={evolution, plasticity,encodings},
  HAL_ID = {hal-00687621},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%

 @inproceedings{mouret:hal-00687633,
  TITLE = {Sferes$_{v2}$: Evolvin' in the Multi-Core World},
  AUTHOR = {Mouret, Jean-Baptiste and Doncieux, St{\'e}phane},
  BOOKTITLE = {12th IEEE Congress on Evolutionary Computation ({CEC'2010})},
  ADDRESS = {France},
  PAGES = {1-8},
  YEAR = {2010},
  DOI = {10.1109/CEC.2010.5586158},
  URL = {https://hal.archives-ouvertes.fr/hal-00687633},
  PDF = {https://hal.archives-ouvertes.fr/hal-00687633/document},
  HAL_ID = {hal-00687633},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no}
}

@inproceedings{terekhov:hal-00687644,
  TITLE = {{Stochastic optimization of a neural network-based controller for aggressive maneuvers on loose surfaces}},
  AUTHOR = {Terekhov, Alexander and Mouret, Jean-Baptiste and Grand, Christophe},
  BOOKTITLE = {{International Conference on Intelligent Robots and Systems (IROS)}},
  ADDRESS = {Taiwan},
  PAGES = {4782-4787},
  YEAR = {2010},
  publisher={IEEE},
  DOI = {10.1109/IROS.2010.5651397},
  URL = {https://hal.archives-ouvertes.fr/hal-00687644},
  PDF = {https://hal.archives-ouvertes.fr/hal-00687644/document},
  HAL_ID = {hal-00687644},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
  keywords={robotics, learning, evolution}
}
%%
@inproceedings{mouret:hal-00687647,
  TITLE = {{Incremental Evolution of Animats' Behaviors as a Multi-objective Optimization}},
  AUTHOR = {Mouret, Jean-Baptiste and Doncieux, St{\'e}phane},
  BOOKTITLE = {{From Animals to Animats 10}},
  ADDRESS = {Japan},
  PAGES = {210-219},
  YEAR = {2008},
  DOI = {10.1007/978-3-540-69134-1\_21},
  URL = {https://hal.archives-ouvertes.fr/hal-00687647},
  PDF = {https://hal.archives-ouvertes.fr/hal-00687647/document},
  HAL_ID = {hal-00687647},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
  keywords={evolution}
}
@inproceedings{cully:hal-00841958,
  TITLE = {{Behavioral Repertoire Learning in Robotics}},
  AUTHOR = {Cully, Antoine and Mouret, Jean-Baptiste},
  BOOKTITLE = {The 15th Annual conference on Genetic and evolutionary computation {(GECCO'13)}},
  ADDRESS = {Amsterdam, Netherlands},
  publisher={{ACM}},
  PAGES = {175-182},
  YEAR = {2013},
  video={https://www.youtube.com/watch?v=2aTIL_c-qwA},
  MONTH = Jul,
  URL = {https://hal.archives-ouvertes.fr/hal-00841958},
  PDF = {https://hal.archives-ouvertes.fr/hal-00841958/document},
  doi={10.1145/2463372.2463399},
  keywords={evolution, robotics,  diversity},
  HAL_ID = {hal-00841958},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
 %%

%%
@inproceedings{tarapore:hal-01302658,
  TITLE = {{How Do Different Encodings Influence the Performance of the MAP-Elites Algorithm?}},
  AUTHOR = {Tarapore, Danesh and Clune, Jeff and Cully, Antoine and Mouret, Jean-Baptiste},
  BOOKTITLE = {{The 18th Annual conference on Genetic and evolutionary computation (GECCO)}},
  YEAR = {2016},
  publisher={{ACM}},
  keywords={illumination, evolution, resilience, robotics, encodings},
  DOI = {10.1145/2908812.2908875},
  URL = {https://hal.inria.fr/hal-01302658},
  PDF = {https://hal.inria.fr/hal-01302658/document},
  SRC={https://github.com/resibots/tarapore_2016_gecco},
  HAL_ID = {hal-01302658},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}
%%
@inproceedings{huizinga:hal-01402502,
  TITLE = {{Does Aligning Phenotypic and Genotypic Modularity Improve the Evolution of Neural Networks?}},
  AUTHOR = {Huizinga, Joost and Mouret, Jean-Baptiste and Clune, Jeff},
  BOOKTITLE = {{The 18th Annual conference on Genetic and evolutionary computation ({GECCO'14})}},
  ADDRESS = {Denver, France},
  PAGES = {125 - 132},
  YEAR = {2016},
  publisher={ACM},
  DOI = {10.1145/2908812.2908836},
  URL = {https://hal.inria.fr/hal-01402502},
  PDF = {https://hal.inria.fr/hal-01402502/document},
  src={http://www.evolvingai.org/files/source_code_modular_alignment.zip},
  HAL_ID = {hal-01402502},
  HAL_VERSION = {v1},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
  doi={10.1145/2908812.2908836},
  keywords={evolution}
}

@inproceedings{gaier2017aaia,
  title={Aerodynamic Design Exploration through Surrogate-Assisted Illumination},
  author={Gaier, Adam and Asteroth, Alexander and Mouret, Jean-Baptiste},
  booktitle={18th {AIAA/ISSMO} Multidisciplinary Analysis and Optimization Conference (\textbf{best student paper})},
  year={2017},
  doi={10.2514/6.2017-3330},
  keywords={evolution, design,illumination},
  pdf={https://hal.inria.fr/hal-01518786/document},
  X-PROCEEDINGS = {no},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}



@INPROCEEDINGS{2014ACTI3079,
	CATEGORY = {ACTI},
	AUTHOR = {Jehanno, J.-M. and Cully, A. and Grand, C. and Mouret, J.-B.},
	TITLE = {Design of a Wheel-Legged Hexapod Robot for Creative Adaptation},
	YEAR = {2014},
	PDF = {http://www.isir.upmc.fr/files/2014ACTI3079.pdf},
	BOOKTITLE = {17th International Conference on Climbing and Walking Robots (CLAWAR)},
  keywords={robotics, resilience},
	PAGES = {267-276},
  video={https://www.youtube.com/watch?v=uIPErWYq1TI},
  doi={10.1142/9789814623353_0032},
  X-PROCEEDINGS = {yes},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}


@INPROCEEDINGS{2014ACTI3119,
	CATEGORY = {ACTI},
	AUTHOR = {Tarapore, D. and Mouret, J.-B.},
	TITLE = {Comparing the evolvability of generative encoding schemes},
	YEAR = {2014},
	PDF = {http://www.isir.upmc.fr/files/2014ACTI3119.pdf},
	BOOKTITLE = {Artificial Life 14: Proceedings of the Fourteenth International Conference on the Synthesis and Simulation of Living Systems},
	PUBLISHER = {MIT Press},
  keywords={evolution, encodings},
	PAGES = {55-62},
	DOI = {10.7551/978-0-262-32621-6-ch011},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}


@INPROCEEDINGS{2014ACTI3120,
	CATEGORY = {ACTI},
	AUTHOR = {Huizinga, J. and Mouret, J.-B. and Clune, J.},
	TITLE = {Evolving Neural Networks That Are Both Modular and Regular: HyperNeat Plus the Connection Cost Technique},
	YEAR = {2014},
	PDF = {https://hal.archives-ouvertes.fr/hal-01300699/document},
	BOOKTITLE = {The 16th Annual conference on Genetic and evolutionary computation ({GECCO'14})},
	publisher={{ACM}},
	PAGES = {1-8},
  DOI={10.1145/2576768.2598232},
  keywords={evolution, encodings},
  VIDEO={https://www.youtube.com/watch?v=t15wUkCXuxQ},
  SRC={http://www.evolvingai.org/files/sferes_modularity_share.zip},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}


@INPROCEEDINGS{2013ACTI2839,
	CATEGORY = {ACTI},
	AUTHOR = {Doncieux, S. and Mouret, J.-B.},
	TITLE = {Behavioral Diversity with Multiple Behavioral Distances},
	YEAR = {2013},
	PDF = {http://www.isir.upmc.fr/files/2013ACTI2839.pdf},
	BOOKTITLE = {15th IEEE Congress on Evolutionary Computation (CEC'13)},
	PAGES = {1-8},
  publisher={{IEEE}},
  keywords={evolution, diversity},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
	doi={10.1109/CEC.2013.6557731},
}


@INPROCEEDINGS{2013ACTI2937,
	CATEGORY = {ACTI},
	AUTHOR = {Oliveira, M. A. and Doncieux, S. and Mouret, J.-B. and Peixoto Santos, C.},
	TITLE = {Optimization of Humanoid Walking Controller: Crossing the Reality Gap},
	YEAR = {2013},
	PDF = {http://www.isir.upmc.fr/files/2013ACTI2937.pdf},
	BOOKTITLE = {Proceedings of IEEE Humanoids},
	PAGES = {1-7},
  X-INTERNATIONAL-AUDIENCE = {yes},
  keywords={evolution, reality-gap, robotics, resilience},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
	doi={10.1109/HUMANOIDS.2013.7029963},
}

@INPROCEEDINGS{2011ACTI1962,
	CATEGORY = {ACTI},
	AUTHOR = {Tonelli, P. and Mouret, J.-B.},
	TITLE = {Using a Map-Based Encoding to Evolve Plastic Neural Networks},
	YEAR = {2011},
	PDF = {http://www.isir.upmc.fr/files/2011ACTI1962.pdf},
	BOOKTITLE = {Proceedings of IEEE Symposium Series on Computational Intelligence},
	PAGES = {9-16},
	DOI = {10.1109/EAIS.2011.5945909},
  keywords={evolution,encodings},
	X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
}

@INPROCEEDINGS{2009ACTI1812,
	CATEGORY = {ACTI},
	AUTHOR = {Tonelli, P. and Mouret, J.-B. and Doncieux, S.},
	TITLE = {Influence of Promoter Length on Network Convergence in GRN-based Evolutionary Algorithms},
	YEAR = {2009},
	PDF = {http://www.isir.upmc.fr/files/2009ACTI1812.pdf},
	BOOKTITLE = {Proceedings of The 10th European Conference on Artificial Life (ECAL)},
	PUBLISHER = {Springer},
	PAGES = {302-309},
  keywords={evolution, biology},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
	doi={10.1007/978-3-642-21314-4_38},
}

@INPROCEEDINGS{2008ACTI937,
	CATEGORY = {ACTI},
	AUTHOR = {Grand, C. and Martinelli, P. and Mouret, J.-B. and Doncieux, S.},
	TITLE = {Flapping-Wing Mechanism for a bird-Sized UAVS: Design, Modeling and Control},
	YEAR = {2008},
	PDF = {http://www.isir.upmc.fr/files/2008ACTI937.pdf},
	BOOKTITLE = {Proceedings of ARK'08 : the 11th International Symposium of Advances in robot kinematics},
	ADDRESS = {France},
	EDITOR = {Lenarcic, J. and Wenger, P.},
	PUBLISHER = {Springer},
	PAGES = {127-136},
	MONTH = {June},
  keywords={robotics, flapping-wing},
  X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
	doi={10.1007/978-1-4020-8600-7_14},
}

@INPROCEEDINGS{2006ACTI462,
	CATEGORY = {ACTI},
	AUTHOR = {Mouret, J.-B. and Doncieux, S. and Meyer, J.-A.},
	TITLE = {Incremental Evolution of Target-Following Neuro-controllers for Flapping-Wing Animats},
	YEAR = {2006},
	KEYWORD = {Evolution},
	PDF = {http://www.isir.upmc.fr/files/2006ACTI462.pdf},
	BOOKTITLE = {From Animals to Animats: Proceedings of the 9th International Conference on the Simulation of Adaptive Behavior (SAB)},
	PAGES = {606--618},
	PROJECT = {Robur},
  video={https://www.youtube.com/watch?v=BfY4jRtcE4c},
  keywords={evolution, flapping-wing},
	X-INTERNATIONAL-AUDIENCE = {yes},
  X-EDITORIAL-BOARD = {yes},
  X-INVITED-CONFERENCE = {no},
  X-SCIENTIFIC-POPULARIZATION = {no},
  doi={10.1007/11840541_50},
}

@inproceedings{gaier:hal-01518698,
  TITLE = {{Data-Efficient Exploration, Optimization, and Modeling of Diverse Designs through Surrogate-Assisted Illumination}},
  AUTHOR = {Gaier, Adam and Asteroth, Alexander and Mouret, Jean-Baptiste},
  BOOKTITLE = {{Genetic and Evolutionary Computation Conference (GECCO)}},
  ADDRESS = {Berlin, Germany},
  YEAR = {2017},
  KEYWORDS = {MAP-Elites, Surrogate Modeling,Aerodynamics, evolution, design,illumination},
  PDF = {https://hal.inria.fr/hal-01518698/file/sail2017.pdf},
  HAL_ID = {hal-01518698},
  HAL_VERSION = {v1},
}

@inproceedings{chatzilygeroudis:hal-01576683,
  TITLE = {{Black-Box Data-efficient Policy Search for Robotics}},
  AUTHOR = {Chatzilygeroudis, Konstantinos and Rama, Roberto and Kaushik, Rituraj and Goepp, Dorian and Vassiliades, Vassilis and Mouret, Jean-Baptiste},
  URL = {https://hal.inria.fr/hal-01576683},
  BOOKTITLE = {{IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)}},
  ADDRESS = {Vancouver, Canada},
  YEAR = {2017},
  video={https://www.youtube.com/watch?v=kTEyYiIFGPM},
  src={https://github.com/resibots/blackdrops},
  MONTH = Sep,
  KEYWORDS = {Data-Efficient Learning, learning, robotics, resilience},
  PDF = {https://hal.inria.fr/hal-01576683/file/medrops-final.pdf},
  HAL_ID = {hal-01576683},
  HAL_VERSION = {v1},
}


@inproceedings{spitz:hal-01569948,
  TITLE = {{Trial-and-Error Learning of Repulsors for Humanoid QP-based Whole-Body Control}},
  AUTHOR = {Spitz, Jonathan and Bouyarmane, Karim and Ivaldi, Serena and Mouret, Jean-Baptiste},
  YEAR = {2017},
  URL = {https://hal.archives-ouvertes.fr/hal-01569948},
  PDF = {https://hal.archives-ouvertes.fr/hal-01569948/file/repulsors.pdf},
  booktitle={Proc. of IEEE Humanoids},
  adress={Birmingham, UK},
  video={https://www.youtube.com/watch?v=InQ0YUBmuNw},
  KEYWORDS = {Data-Efficient Learning, learning, robotics, resilience, humanoid},
  HAL_VERSION = {v1},
}

@inproceedings{paul:hal-01644063,
  TITLE = {{Alternating Optimisation and Quadrature for Robust Control}},
  AUTHOR = {Paul, Supratik and Chatzilygeroudis, Konstantinos and Ciosek, Kamil and Mouret, Jean-Baptiste and Osborne, Michael A and Whiteson, Shimon},
  URL = {https://hal.inria.fr/hal-01644063},
  BOOKTITLE = {{AAAI 2018 - The Thirty-Second AAAI Conference on Artificial Intelligence}},
  ADDRESS = {New Orleans, United States},
  YEAR = {2018},
  MONTH = Feb,
  PDF = {https://hal.inria.fr/hal-01644063/file/ALOQ_AAAI18_final.pdf},
  HAL_ID = {hal-01644063},
  keywords={resilience, robotics},
  HAL_VERSION = {v1},
}



@inproceedings{pautrat2017bayesian,
  title={Bayesian Optimization with Automatic Prior Selection for Data-Efficient Direct Policy Search},
  author={Pautrat, R\'emi and Chatzilygeroudis, Konstantinos and Mouret, Jean-Baptiste},
  booktitle={IEEE International Conference on Robotics and Automation (ICRA)},
  year={2018},
  video={https://www.youtube.com/watch?v=iiVaV-U6Kqo},
  PDF={https://arxiv.org/pdf/1709.06919.pdf},
  keywords={resilience, robotics},
  END={}
}

@inproceedings{chatzilygeroudis2017using,
  title={Using Parameterized Black-Box Priors to Scale Up Model-Based Policy Search for Robotics},
  author={Chatzilygeroudis, Konstantinos and Mouret, Jean-Baptiste},
  booktitle={IEEE International Conference on Robotics and Automation (ICRA)},
  year={2018},
  keywords={resilience, robotics},
  url={https://arxiv.org/abs/1709.06917},
  video={https://www.youtube.com/watch?v=_MZYDhfWeLc},
  PDF={https://arxiv.org/pdf/1709.06917.pdf},
  END={}
}


@inproceedings{vassiliades:hal-01764739,
  TITLE = {{Discovering the Elite Hypervolume by Leveraging Interspecies Correlation}},
  AUTHOR = {Vassiliades, Vassilis and Mouret, Jean-Baptiste},
  BOOKTITLE = {Genetic and Evolutionary Computation Conference ({GECCO})},
  ADDRESS = {Kyoto, Japan},
  YEAR = {2018},
  MONTH = Jul,
  DOI = {10.1145/3205455.3205602},
  PDF = {https://arxiv.org/pdf/1804.03906.pdf},
  KEYWORDS = {illumination, MAP-Elites, quality diversity, diversity, evolution},
  HAL_ID = {hal-01764739},
  HAL_VERSION = {v1},
}

@inproceedings{gaier:hal-01768248,
  TITLE = {{Data-efficient Neuroevolution with Kernel-Based Surrogate Models}},
  AUTHOR = {Gaier, Adam and Asteroth, Alexander and Mouret, Jean-Baptiste},
  URL = {https://arxiv.org/abs/1804.05364},
  BOOKTITLE = {Genetic and Evolutionary Computation Conference ({GECCO})},
  ADDRESS = {Kyoto, Japan},
  YEAR = {2018},
  DOI = {10.1145/3205455.3205510},
  KEYWORDS = {NEAT ; Surrogate Modeling ; Neuroevolution, evolution},
  PDF = {https://hal.inria.fr/hal-01768248/file/1804.05364.pdf},
  keywords={robotics, encodings},
  HAL_ID = {hal-01768248},
  HAL_VERSION = {v1},
}


@inproceedings{multi-dex2018,
  TITLE = {Multi-objective Model-based Policy Search for Data-efficient Learning with Sparse Rewards},
  AUTHOR = {Kaushik, Rituraj and Chatzilygeroudis, Konstantinos and Mouret, Jean-Baptiste},
  URL = {https://arxiv.org/abs/1806.09351},
  PDF = {https://hal.inria.fr/hal-01884294/document},
  BOOKTITLE = {Conference on Robot Learning (CoRL)},
  ADDRESS = {Zurich, Switzerland},
  YEAR = {2018},
  keywords={robotics, resilience, diversity},
}


@inproceedings{penco2018robust,
  title={Robust Real-time Whole-Body Motion Retargeting from Human to Humanoid},
  author={Penco, L and Cl{\'e}ment, Brice and Modugno, V and Hoffman, E Mingo and Nava, Gabriele and Pucci, Daniele and Tsagarakis, Nikos G and Mouret, J-B and Ivaldi, Serena},
  booktitle={IEEE-RAS 18th International Conference on Humanoid Robots (Humanoids)},
  pages={425--432},
  year={2018},
  organization={IEEE},
  pdf={https://hal.archives-ouvertes.fr/hal-01895145/file/_LARGE__bf_Robust_Real_time_Whole_Body_Motion_Retargeting____from_Human_to_Humanoid.pdf},
  url={https://ieeexplore.ieee.org/abstract/document/8624943/}
}

@inproceedings{gomes2019humanoids,
  title={Humanoid Whole-Body Movement Optimization from Retargeted Human Motions},
  author={Gomes, Waldez and Radhakrishnan, Vishnu and Penco, Luigi and Modugno, Valerio and Mouret, Jean-Baptiste and Ivaldi, Serena},
  year={2019},
  booktitle={IEEE-RAS International Conference on Humanoid Robots},
  keywords={robotics},
  url={https://hal.archives-ouvertes.fr/hal-02290473/},
  pdf={https://hal.archives-ouvertes.fr/hal-02290473/document}
}

@article{cully2017quality,
  title={Quality and diversity optimization: A unifying modular framework},
  author={Cully, Antoine and Demiris, Yiannis},
  journal={IEEE Transactions on Evolutionary Computation},
  volume={22},
  number={2},
  pages={245--259},
  year={2017},
  publisher={IEEE}
}

@article{pugh2016quality,
  title={Quality diversity: A new frontier for evolutionary computation},
  author={Pugh, Justin K and Soros, Lisa B and Stanley, Kenneth O},
  journal={Frontiers in Robotics and AI},
  volume={3},
  pages={40},
  year={2016},
  publisher={Frontiers}
}


@inproceedings{dacosta2008adaptive,
  title={Adaptive operator selection with dynamic multi-armed bandits},
  author={DaCosta, Luis and Fialho, Alvaro and Schoenauer, Marc and Sebag, Mich{\`e}le},
  booktitle={Genetic and Evolutionary Computation (GECCO)},
  pages={913--920},
  year={2008}
}


@article{shahriari2015taking,
  title={Taking the human out of the loop: A review of Bayesian optimization},
  author={Shahriari, Bobak and Swersky, Kevin and Wang, Ziyu and Adams, Ryan P and De Freitas, Nando},
  journal={Proceedings of the IEEE},
  volume={104},
  number={1},
  pages={148--175},
  year={2015},
  publisher={IEEE}
}

@article{auer2002finite,
  title={Finite-time analysis of the multiarmed bandit problem},
  author={Auer, Peter and Cesa-Bianchi, Nicolo and Fischer, Paul},
  journal={Machine learning},
  volume={47},
  number={2-3},
  pages={235--256},
  year={2002},
  publisher={Springer}
}


@article{audibert2009exploration,
  title={Exploration--exploitation tradeoff using variance estimates in multi-armed bandits},
  author={Audibert, Jean-Yves and Munos, R{\'e}mi and Szepesv{\'a}ri, Csaba},
  journal={Theoretical Computer Science},
  volume={410},
  number={19},
  pages={1876--1902},
  year={2009},
  publisher={Elsevier}
}

@inproceedings{yu2019meta,
  title={Meta-world: A benchmark and evaluation for multi-task and meta reinforcement learning},
  author={Yu, Tianhe and Quillen, Deirdre and He, Zhanpeng and Julian, Ryan and Hausman, Karol and Finn, Chelsea and Levine, Sergey},
  booktitle={Proc. of CoRL},
  year={2019}
}


@article{gupta2015multifactorial,
  title={Multifactorial evolution: toward evolutionary multitasking},
  author={Gupta, Abhishek and Ong, Yew-Soon and Feng, Liang},
  journal={IEEE Transactions on Evolutionary Computation},
  volume={20},
  number={3},
  pages={343--357},
  year={2015},
  publisher={IEEE}
}


@article{hansen2003reducing,
  title={Reducing the time complexity of the derandomized evolution strategy with covariance matrix adaptation (CMA-ES)},
  author={Hansen, Nikolaus and M{\"u}ller, Sibylle D and Koumoutsakos, Petros},
  journal={Evolutionary Computation},
  volume={11},
  number={1},
  pages={1--18},
  year={2003},
  publisher={MIT Press}
}

@ARTICLE{kaushik2020,
AUTHOR={Kaushik, Rituraj and Desreumaux, Pierre and Mouret, Jean-Baptiste},
TITLE={Adaptive Prior Selection for Repertoire-Based Online Adaptation in Robotics},
JOURNAL={Frontiers in Robotics and AI},
VOLUME={6},
PAGES={151},
YEAR={2020},
DOI={10.3389/frobt.2019.00151},
ISSN={2296-9144}
}

@article{duarte2017evolution,
  title={Evolution of repertoire-based control for robots with complex locomotor systems},
  author={Duarte, Miguel and Gomes, Jorge and Oliveira, Sancho Moura and Christensen, Anders Lyhne},
  journal={IEEE Transactions on Evolutionary Computation},
  volume={22},
  number={2},
  pages={314--328},
  year={2017},
  publisher={IEEE}
}

@article{coumans2016pybullet,
  title={Pybullet, a python module for physics simulation for games, robotics and machine learning},
  author={Coumans, Erwin and Bai, Yunfei},
  journal={GitHub repository},
  year={2016}
}

@inproceedings{hansen2010comparing,
  title={Comparing results of 31 algorithms from the black-box optimization benchmarking BBOB-2009},
  author={Hansen, Nikolaus and Auger, Anne and Ros, Raymond and Finck, Steffen and Po{\v{s}}{\'\i}k, Petr},
  booktitle={Genetic and evolutionary computation Companion (GECCO)},
  pages={1689--1696},
  year={2010}
}

@inproceedings{hashimoto2018analysis,
  title={Analysis of evolutionary multi-tasking as an island model},
  author={Hashimoto, Ryuichi and Ishibuchi, Hisao and Masuyama, Naoki and Nojima, Yusuke},
  booktitle={Genetic and Evolutionary Computation Conference Companion (GECCO)},
  pages={1894--1897},
  year={2018}
}

@article{da2017evolutionary,
  title={Evolutionary multitasking for single-objective continuous optimization: Benchmark problems, performance metric, and baseline results},
  author={Da, Bingshui and Ong, Yew-Soon and Feng, Liang and Qin, A Kai and Gupta, Abhishek and Zhu, Zexuan and Ting, Chuan-Kang and Tang, Ke and Yao, Xin},
  journal={arXiv preprint arXiv:1706.03470},
  year={2017}
}


@article{fabisch2014active,
  title={Active contextual policy search},
  author={Fabisch, Alexander and Metzen, Jan Hendrik},
  journal={The Journal of Machine Learning Research},
  volume={15},
  number={1},
  pages={3371--3399},
  year={2014},
  publisher={JMLR. org}
}


@article{fruitfly,
  title={The genome sequence of Drosophila melanogaster},
  author={Adams, Mark D and Celniker, Susan E and Holt, Robert A and Evans, Cheryl A and Gocayne, Jeannine D and Amanatides, Peter G and Scherer, Steven E and Li, Peter W and Hoskins, Roger A and Galle, Richard F and others},
  journal={Science},
  volume={287},
  number={5461},
  pages={2185--2195},
  year={2000},
  publisher={American Association for the Advancement of Science}
}

@article{sareni1998fitness,
  title={Fitness sharing and niching methods revisited},
  author={Sareni, Bruno and Krahenbuhl, Laurent},
  journal={IEEE transactions on Evolutionary Computation},
  volume={2},
  number={3},
  pages={97--106},
  year={1998},
  publisher={IEEE}
}

@article{lehman2011abandoning,
  title={Abandoning objectives: Evolution through the search for novelty alone},
  author={Lehman, Joel and Stanley, Kenneth O},
  journal={Evolutionary Computation},
  volume={19},
  number={2},
  pages={189--223},
  year={2011},
  publisher={MIT Press}
}

@inproceedings{lehman2011evolving,
  title={Evolving a diversity of virtual creatures through novelty search and local competition},
  author={Lehman, Joel and Stanley, Kenneth O},
  booktitle={Genetic and Evolutionary Computation (GECCO)},
  pages={211--218},
  year={2011}
}

@article{brochu2010tutorial,
  title={A tutorial on Bayesian optimization of expensive cost functions, with application to active user modeling and hierarchical reinforcement learning},
  author={Brochu, Eric and Cora, Vlad M and De Freitas, Nando},
  journal={arXiv preprint arXiv:1012.2599},
  year={2010}
}

@MISC{coumans2019,
author =   {Erwin Coumans and Yunfei Bai},
title =    {PyBullet, a Python module for physics simulation for games, robotics and machine learning},
howpublished = {\url{http://pybullet.org}},
year = {2016--2019}
}

@article{schulman2017proximal,
  title={Proximal policy optimization algorithms},
  author={Schulman, John and Wolski, Filip and Dhariwal, Prafulla and Radford, Alec and Klimov, Oleg},
  journal={arXiv preprint arXiv:1707.06347},
  year={2017}
}

@inproceedings{schulman2015trust,
  title={Trust region policy optimization},
  author={Schulman, John and Levine, Sergey and Abbeel, Pieter and Jordan, Michael and Moritz, Philipp},
  booktitle={International Conference on Machine Learning (ICML)},
  pages={1889--1897},
  year={2015}
}

@inproceedings{haarnoja2018soft,
  title={Soft Actor-Critic: Off-Policy Maximum Entropy Deep Reinforcement Learning with a Stochastic Actor},
  author={Haarnoja, Tuomas and Zhou, Aurick and Abbeel, Pieter and Levine, Sergey},
  booktitle={International Conference on Machine Learning},
  pages={1861--1870},
  year={2018}
}

@inproceedings{smith2010analyzing,
  title={Analyzing the expressive range of a level generator},
  author={Smith, Gillian and Whitehead, Jim},
  booktitle={Proceedings of the 2010 Workshop on Procedural Content Generation in Games},
  pages={1--7},
  year={2010}
}
@inproceedings{summerville2018expanding,
  title={Expanding expressive range: Evaluation methodologies for procedural content generation},
  author={Summerville, Adam},
  booktitle={Fourteenth Artificial Intelligence and Interactive Digital Entertainment Conference},
  year={2018}
}
@article{justesen2018illuminating,
  title={Illuminating generalization in deep reinforcement learning through procedural level generation},
  author={Justesen, Niels and Torrado, Ruben Rodriguez and Bontrager, Philip and Khalifa, Ahmed and Togelius, Julian and Risi, Sebastian},
  journal={arXiv preprint arXiv:1806.10729 / NeurIPS Deep RL Workshop},
  year={2018}
}
</script>
